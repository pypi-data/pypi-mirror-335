"use strict";(self.webpackChunk_jupyterlite_xeus_extension=self.webpackChunk_jupyterlite_xeus_extension||[]).push([[961],{961:(e,n,t)=>{t.r(n),t.d(n,{IEmpackEnvMetaFile:()=>g,default:()=>f});var o=t(874),r=t(390),s=t(97),a=t(240),l=t(367),i=t(529),c=t(754),u=t(907),d=t(764);const g=new(t(262).Token)("@jupyterlite/xeus:IEmpackEnvMetaFile");var k;async function v(e){const n=l.URLExt.join(l.PageConfig.getBaseUrl(),e),t=await fetch(n,{method:"GET"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}!function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(k||(k={}));const w={id:"@jupyterlite/xeus-kernel:register",autoStart:!0,requires:[u.IKernelSpecs],optional:[i.IServiceWorkerManager,c.IBroadcastChannelWrapper,g],activate:async(e,n,t,o,r)=>{let s=[];try{s=await v("xeus/kernels.json")}catch(e){throw console.log(`Could not fetch xeus/kernels.json: ${e}`),e}const a=e.serviceManager.contents;for(const e of s){const s=await v("xeus/kernels/"+e+"/kernel.json");s.name=e,s.dir=e;for(const[e,n]of Object.entries(s.resources))s.resources[e]=l.URLExt.join(l.PageConfig.getBaseUrl(),n);n.register({spec:s,create:async e=>{const n=!!((null==t?void 0:t.enabled)&&(null==o?void 0:o.enabled)||crossOriginIsolated);n?console.info(`${s.name} contents will be synced with Jupyter Contents`):console.warn(`${s.name} contents will NOT be synced with Jupyter Contents`);const l=r?await r.getLink(s):"";return new d.WebWorkerKernel({...e,contentsManager:a,mountDrive:n,kernelSpec:s,empackEnvMetaLink:l})}})}await e.serviceManager.kernelspecs.refreshSpecs()}},p={id:"@jupyterlite/xeus:empack-env-meta",autoStart:!0,provides:g,activate:()=>({getLink:async e=>{const n=e.name;return`${l.URLExt.join(l.PageConfig.getBaseUrl(),`xeus/kernels/${n}`)}`}})},f=[{id:"@jupyterlite/xeus-extension:xeus-kernel-status",autoStart:!0,requires:[o.IToolbarWidgetRegistry,s.IRenderMimeRegistry],activate:async(e,n,t)=>{n&&n.addFactory("Notebook","xeusKernelLogs",(n=>{const s=n.sessionContext;let l,i,c,u,d,g=k.None;const v=()=>{c&&(d=new o.MainAreaWidget({content:c}),d.title.label="Kernel Logs",d.title.icon=r.listIcon,d.id=`${u}-widget`)},w=new r.ToolbarButton({icon:r.listIcon,onClick:()=>{c?(d||v(),d&&(d.isDisposed&&v(),d.isAttached||e.shell.add(d,"main",{mode:"split-bottom"}),e.shell.activateById(d.id))):(0,o.showErrorMessage)("Cannot show logs","Cannot show logs for the current kernel")},tooltip:"Show kernel logs"});return s.kernelChanged.connect((()=>{var e,n,o,r;if(l=null===(e=s.session)||void 0===e?void 0:e.id,i=null===(o=null===(n=s.session)||void 0===n?void 0:n.kernel)||void 0===o?void 0:o.name,g=k.None,!l||!i)return;u=`${i}-${l}`,c=new a.LogConsolePanel(new a.LoggerRegistry({defaultRendermime:t,maxLength:1e3})),c.source=u;const d=new BroadcastChannel(`/kernel-broadcast/${l}`);c.logger&&(c.logger.level="info"),null===(r=c.logger)||void 0===r||r.contentChanged.connect((()=>{const e=document.getElementById(`source:${u}`);if(!e)return;const n=e.lastElementChild;n&&n.scrollIntoView({behavior:"smooth"})})),d.onmessage=e=>{var n,t,o;if(c)switch(e.data.type){case"log":null===(n=c.logger)||void 0===n||n.log({type:"text",level:"info",data:e.data.msg}),g<k.Info&&(g=k.Info,w.addClass("xeus-kernel-status-info"));break;case"warn":null===(t=c.logger)||void 0===t||t.log({type:"text",level:"warning",data:e.data.msg}),g<k.Warning&&(g=k.Warning,w.addClass("xeus-kernel-status-warning"));break;case"error":null===(o=c.logger)||void 0===o||o.log({type:"text",level:"error",data:e.data.msg}),g<k.Error&&(g=k.Error,w.addClass("xeus-kernel-status-error"))}}})),w}))}},p,w]}}]);