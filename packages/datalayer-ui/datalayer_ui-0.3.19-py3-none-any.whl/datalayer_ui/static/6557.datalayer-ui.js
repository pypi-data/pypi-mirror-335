"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[6557],{25255:(e,s,n)=>{n.d(s,{Z:()=>l});var t=n(45205),a=n(68110),i=n(43275),o=n(16909),r=n(47011);function l(e){const{commandRegistry:s,kernelDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,o.useState)();return(0,o.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.r,{variant:"invisible",size:"small",leadingVisual:i.Mfv,disabled:void 0===n?.location,onClick:l,children:"Save"}),(0,r.jsx)(a.r,{variant:"invisible",size:"small",leadingVisual:i.o1U,disabled:!n?.location||"busy"===d,onClick:e=>{s?.execute(t.zl.runAll)},children:"Run all"}),(0,r.jsx)(a.r,{variant:"invisible",size:"small",leadingVisual:i.wNq,disabled:!n?.location||"busy"!==d,onClick:e=>{s?.execute(t.zl.interrupt)},children:"Interrupt"})]})}},26557:(e,s,n)=>{n.r(s),n.d(s,{LessonEdit:()=>B,default:()=>L});var t=n(16909),a=n(97663),i=n(88625),o=n(15358),r=n(82176),l=n(34166),c=n(68110),d=n(97666),u=n(44860),h=n(79424),m=n(88567),p=n(43275),x=n(55484),v=n(46523),y=n(85741),f=n(25255),g=n(85730),j=n(68495),k=n(45741),b=n(35928),Z=n(19459),C=n(52999),S=n(47011);const B=()=>{const e=(0,t.useMemo)((()=>[new x.l]),[]),{lessonId:s}=(0,a.UO)();if(!s)return(0,S.jsx)(S.Fragment,{});const n=(0,g.a)(),B=(0,i.N)(),L=(0,j.s)(),N=(0,Z.qX)(),w=(0,v.qL)(),R=N.layout().space,z=(0,C.D1)().saveRequest,I=w.selectNotebookModel(s),{cloneLesson:E,getLesson:T,refreshLesson:V,updateNotebook:q,updateNotebookModel:D}=(0,k.Y)(),[M,P]=(0,t.useState)("editor"),{enqueueToast:F}=(0,b.p)(),[_,A]=(0,t.useState)(),[O,U]=(0,t.useState)({name:"",description:""}),[J,H]=(0,t.useState)({name:void 0,description:void 0}),X=(e,s)=>{s.preventDefault(),N.layout().resetRightPortal(),P(e)};(0,t.useEffect)((()=>(N.layout().showBackdrop(),V(s).then((e=>{if(N.layout().hideBackdrop(),e.success){const e=T(s);e?(A(e),N.layout().setItem(e),U({name:e.name,description:e.description})):L("/")}})).finally((()=>{N.layout().hideBackdrop()})),()=>{A(void 0),w.reset(),N.layout().setItem(void 0)})),[s]);const Y=()=>{I?.model?.cells&&(N.layout().showBackdrop("Saving the lesson..."),D(s,I.model.toJSON()).then((e=>{e.success&&(F("The lesson is successfully updated.",{variant:"success"}),N.layout().triggerItemsRefresh(),A({..._,nbformat:I.model.toJSON()}))})).finally((()=>{N.layout().hideBackdrop()})))};(0,t.useEffect)((()=>{z&&_&&Y()}),[z]),(0,t.useEffect)((()=>{H({...J,name:void 0===O.name?void 0:O.name.length>2,description:void 0===O.description?void 0:O.description.length>2})}),[O]);const $=(0,t.useCallback)((async e=>{B({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then((e=>{e&&(N.layout().showBackdrop(),E(s).then((e=>{N.layout().hideBackdrop(),e.success&&(F(e.message,{variant:"success"}),N.layout().triggerItemsRefresh(),L(`/${n?.handle}/library/lessons`))})).finally((()=>{N.layout().hideBackdrop()})))}))}),[B,_]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.m,{children:(0,S.jsxs)(r.Z,{display:"flex",children:[(0,S.jsx)(r.Z,{flex:1,children:(0,S.jsx)(l.Z,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===M&&(0,S.jsx)(r.Z,{children:(0,S.jsx)(f.Z,{commandRegistry:w.selectNotebookAdapter(s)?.commands,save:Y})}),_&&R&&(0,S.jsx)(r.Z,{children:(0,S.jsx)(c.r,{variant:"invisible",size:"small",leadingVisual:p.jcu,onClick:$,children:"Clone"})})]})}),_&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(d.Z,{sx:{mt:3,mb:3},children:[(0,S.jsx)(d.Z.Link,{href:"",selected:"editor"===M,onClick:e=>X("editor",e),children:"Editor"}),(0,S.jsx)(d.Z.Link,{href:"",selected:"properties"===M,onClick:e=>X("properties",e),children:"Properties"})]}),"editor"===M&&(0,S.jsx)(r.Z,{children:_.nbformat&&(0,S.jsx)(y.a,{id:s,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:_.nbformat,extensions:e})}),"properties"===M&&(0,S.jsx)(r.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,S.jsx)(r.Z,{children:(0,S.jsxs)(r.Z,{sx:{label:{marginTop:2}},children:[(0,S.jsxs)(u.Z,{children:[(0,S.jsx)(u.Z.Label,{children:"Name"}),(0,S.jsx)(h.Z,{block:!0,value:O.name,onChange:e=>{U((s=>({...s,name:e.target.value})))}}),!1===J.name&&(0,S.jsx)(u.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(u.Z,{children:[(0,S.jsx)(u.Z.Label,{children:"Description"}),(0,S.jsx)(m.ZP,{block:!0,value:O.description,onChange:e=>{U((s=>({...s,description:e.target.value})))}}),!1===J.description&&(0,S.jsx)(u.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(u.Z,{children:(0,S.jsx)(c.r,{variant:"primary",disabled:!J.name||!J.description,sx:{marginTop:2},onClick:async()=>{N.layout().showBackdrop(),q(s,O.name,O.description).then((e=>{N.layout().hideBackdrop(),e.success&&(F("The lesson is successfully updated.",{variant:"success"}),N.layout().triggerItemsRefresh(),A({..._,name:O.name,description:O.description}))})).finally((()=>{N.layout().hideBackdrop()}))},children:"Update lesson"})})]})})})]})]})},L=B}}]);