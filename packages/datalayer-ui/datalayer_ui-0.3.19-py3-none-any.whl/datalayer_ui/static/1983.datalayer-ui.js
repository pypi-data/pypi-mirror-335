"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[1983],{25255:(e,s,n)=>{n.d(s,{Z:()=>o});var t=n(45205),i=n(68110),a=n(43275),r=n(16909),l=n(47011);function o(e){const{commandRegistry:s,kernelDesc:n,save:o,sessionConnection:c}=e,[d,u]=(0,r.useState)();return(0,r.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.r,{variant:"invisible",size:"small",leadingVisual:a.Mfv,disabled:void 0===n?.location,onClick:o,children:"Save"}),(0,l.jsx)(i.r,{variant:"invisible",size:"small",leadingVisual:a.o1U,disabled:!n?.location||"busy"===d,onClick:e=>{s?.execute(t.zl.runAll)},children:"Run all"}),(0,l.jsx)(i.r,{variant:"invisible",size:"small",leadingVisual:a.wNq,disabled:!n?.location||"busy"!==d,onClick:e=>{s?.execute(t.zl.interrupt)},children:"Interrupt"})]})}},41983:(e,s,n)=>{n.r(s),n.d(s,{AssignmentEdit:()=>R,default:()=>V});var t=n(16909),i=n(97663),a=n(88625),r=n(15358),l=n(82176),o=n(34166),c=n(23363),d=n(68110),u=n(97666),h=n(44860),m=n(79424),g=n(88567),p=n(1481),x=n(67369),v=n(43275),f=n(87602),j=n(46523),y=n(55484),k=n(53969),b=n(85741),Z=n(85730),C=n(68495),S=n(45741),N=n(35928),w=n(19459),z=n(52999),B=n(25255),A=n(47011);const R=()=>{const{assignmentId:e}=(0,i.UO)();if(!e)return(0,A.jsx)(A.Fragment,{});const s=(0,Z.a)(),n=(0,a.N)(),R=(0,C.s)(),V=(0,w.qX)(),I=(0,j.qL)(),D=(0,z.D1)(),L=V.layout().space,M=D.saveRequest,E=I.selectNotebookModel(e),{cloneAssignment:T,getAssignment:U,getAssignmentStudentVersion:q,refreshAssignment:F,updateNotebookModel:O,updateNotebook:J}=(0,S.Y)(),{enqueueToast:P}=(0,N.p)(),[_,H]=(0,t.useState)("editor"),[$,G]=(0,t.useState)(!1),[Q,X]=(0,t.useState)(void 0),[Y,K]=(0,t.useState)([]),[W,ee]=(0,t.useState)(),[se,ne]=(0,t.useState)({name:"",description:""}),[te,ie]=(0,t.useState)({name:void 0,description:void 0}),ae=(0,t.useMemo)((()=>[new y.l]),[]),re=(0,t.useMemo)((()=>[new y.l({factory:k.l})]),[]),le=(e,s)=>{s.preventDefault(),V.layout().resetRightPortal(),K([]),H(e)};(0,t.useEffect)((()=>{if(e&&"editor"===_)return V.layout().showBackdrop("Loading the assignment..."),F(e).then((s=>{if(s.success){const s=U(e);s?(ee(s),V.layout().setItem(s),ne({name:s.name,description:s.description})):R("/")}})).finally((()=>{V.layout().hideBackdrop()})),()=>{I.reset(),V.layout().setItem(void 0)}}),[e,_]);const oe=()=>{E?.model?.cells&&(V.layout().showBackdrop("Saving the assignment..."),O(e,E.model.toJSON()).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),V.layout().triggerItemsRefresh(),ee({...W,nbformat:E.model.toJSON()}))})).finally((()=>{V.layout().hideBackdrop()})))},ce=s=>{E?.model?.cells&&(s.preventDefault(),V.layout().showBackdrop("Generating the student version of the assignment..."),O(e,E.model.toJSON()),q(e).then((e=>{G(!0),le("student",s),e.success?X(JSON.parse(e.notebook)):e.errors&&K(e.errors)})).finally((()=>{V.layout().hideBackdrop()})))};(0,t.useEffect)((()=>{M&&W&&oe()}),[M]),(0,t.useEffect)((()=>{ie({...te,name:void 0===se.name?void 0:se.name.length>2,description:void 0===se.description?void 0:se.description.length>2})}),[se]);const de=(0,t.useCallback)((async t=>{n({title:"Are you sure?",content:"Please confirm you want to clone this assignment in your private library."}).then((n=>{n&&(V.layout().showBackdrop(),T(e).then((e=>{e.success&&(P(e.message,{variant:"success"}),V.layout().triggerItemsRefresh(),R(`/${s?.handle}/library/assignments`))})).finally((()=>{V.layout().hideBackdrop()})))}))}),[n,W]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(r.m,{children:(0,A.jsxs)(l.Z,{display:"flex",children:[(0,A.jsx)(l.Z,{flex:1,children:(0,A.jsx)(o.Z,{sx:{fontSize:3},children:"Assignment editor"})}),"student"!==_&&(0,A.jsxs)(l.Z,{display:"flex",children:[(0,A.jsx)(B.Z,{commandRegistry:I.selectNotebookAdapter(e)?.commands,save:oe}),(0,A.jsx)(c.Z,{children:(0,A.jsx)(d.r,{variant:"invisible",size:"small",leadingVisual:f.Z,onClick:e=>ce(e),children:"Student version"})}),W&&L&&(0,A.jsx)(d.r,{variant:"invisible",size:"small",leadingVisual:v.jcu,onClick:de,children:"Clone"})]})]})}),W&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(u.Z,{sx:{mt:3,mb:3},children:[(0,A.jsx)(u.Z.Link,{href:"",selected:"editor"===_,onClick:e=>le("editor",e),children:"Editor"}),(0,A.jsx)(u.Z.Link,{href:"",selected:"properties"===_,onClick:e=>le("properties",e),children:"Properties"}),(0,A.jsx)(u.Z.Link,{href:"",selected:"student"===_,onClick:e=>ce(e),children:"Student version"})]}),"editor"===_&&(0,A.jsx)(l.Z,{children:W.nbformat&&(0,A.jsx)(b.a,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:W.nbformat,extensions:ae,cellSidebarMargin:200})}),"properties"===_&&(0,A.jsx)(l.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,A.jsx)(l.Z,{children:(0,A.jsxs)(l.Z,{sx:{label:{marginTop:2}},children:[(0,A.jsxs)(h.Z,{children:[(0,A.jsx)(h.Z.Label,{children:"Name"}),(0,A.jsx)(m.Z,{block:!0,value:se.name,onChange:e=>{ne((s=>({...s,name:e.target.value})))}}),!1===te.name&&(0,A.jsx)(h.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,A.jsxs)(h.Z,{children:[(0,A.jsx)(h.Z.Label,{children:"Description"}),(0,A.jsx)(g.ZP,{block:!0,value:se.description,onChange:e=>{ne((s=>({...s,description:e.target.value})))}}),!1===te.description&&(0,A.jsx)(h.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,A.jsx)(h.Z,{children:(0,A.jsx)(d.r,{variant:"primary",disabled:!te.name||!te.description,sx:{marginTop:2},onClick:async()=>{V.layout().showBackdrop("Updating assignment..."),J(e,se.name,se.description).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),V.layout().triggerItemsRefresh(),ee({...W,name:se.name,description:se.description}))})).finally((()=>{V.layout().hideBackdrop()}))},children:"Update assignment"})})]})})}),"student"===_&&(0,A.jsxs)(l.Z,{ml:3,mr:3,children:[(0,A.jsx)(p.Z,{variant:"warning",children:"Student version of the assignment."}),Y.map((e=>(0,A.jsxs)(p.Z,{variant:"danger",children:[(0,A.jsx)(x.Z,{icon:v.zMQ}),e]}))),Q&&0===Y.length&&(0,A.jsx)(b.a,{id:`${e}-student`,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:Q,readonly:!0,extensions:re})]})]})]})},V=R},53969:(e,s,n)=>{n.d(s,{l:()=>c});var t=n(47011),i=n(34441),a=n(70994),r=n(81158),l=n(45205),o=n(23577);function c(e){const{commands:s}=e;return(0,t.jsx)(a.Z,{className:o.UI,sx:{"& p":{marginBottom:"0 !important"}},children:(0,t.jsx)(r.r,{trailingVisual:i.o1U,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),s.execute(l.zl.run).catch((e=>{console.error("Failed to run cell.",e)}))},children:"Run"})})}}}]);