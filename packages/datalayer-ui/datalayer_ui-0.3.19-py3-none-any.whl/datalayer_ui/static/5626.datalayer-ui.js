"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5626],{75626:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$});var n=i(74608),s=i(61140);const o="CompletionProvider:context";class r{constructor(){this.identifier=o,this.rank=500,this.renderer=null}async isApplicable(e){return!0}fetch(e,t){const i=t.editor;return i?new Promise((e=>{e(l.contextHint(i))})):Promise.reject("No editor")}}var l;!function(e){e.contextHint=function(e){const t=e.getTokenAtCursor(),i=function(e,t){return t.getTokens().filter((t=>0===t.value.indexOf(e.value)&&t.value!==e.value))}(t,e).filter((e=>e.type)).map((e=>e.value)),n=new Set(i),s=new Array;return n.forEach((e=>s.push({label:e}))),{start:t.offset,end:t.offset+t.value.length,items:s}}}(l||(l={}));var a=i(3202),d=i(74260),c=i(9706);class h{constructor(e){this.options=e,this.identifier="@jupyterlab/inline-completer:history",this._maxSuggestions=100;const t=e.translator||d.Sr;this._trans=t.load("jupyterlab")}get name(){return this._trans.__("History")}get icon(){return c.Dc}get schema(){return{properties:{maxSuggestions:{title:this._trans.__("Maximum number of suggestions"),description:this._trans.__("The maximum number of suggestions to retrieve from history."),type:"number"}},default:{enabled:!1,maxSuggestions:100}}}configure(e){var t;this._maxSuggestions=null!==(t=e.maxSuggestions)&&void 0!==t?t:100}async fetch(e,t,i){var n;const s=null===(n=t.session)||void 0===n?void 0:n.kernel;if(!s)throw new Error("No kernel for completion request.");const o=e.text.slice(0,e.offset).split("\n").slice(-1)[0],r={output:!1,raw:!0,hist_access_type:"search",pattern:o+"*",unique:!0,n:this._maxSuggestions},l=await s.requestHistory(r),a=[];if(""===o)return{items:[]};if("ok"===l.content.status)for(const e of l.content.history){const t=e[2].split("\n");for(let e=0;e<t.length;e++){const i=t[e];if(i.startsWith(o)){const n=i.slice(o.length,i.length)+"\n"+t.slice(e+1).join("\n");a.push({insertText:n})}}}return{items:a}}}var u,p=i(54362),m=i(59555),v=i(76395),g=i(98335),_=i(66105);class f{constructor(e){this.options=e}placeGhost(e,t){const i=[u.addMark.of(t)];e.state.field(u.markField,!1)||(i.push(_.Py.appendConfig.of([u.markField])),i.push(_.Py.appendConfig.of([g.tk.domEventHandlers({blur:t=>{if(!1===this.options.onBlur(t))return!0;const i=[u.removeMark.of(null)];setTimeout((()=>{e.dispatch({effects:i})}),0)}})]))),e.dispatch({effects:i})}clearGhosts(e){const t=[u.removeMark.of(null)];e.dispatch({effects:t})}}f.streamingAnimation="uncover";class w extends g.l9{constructor(e){super(),this.options=e,this.isSpacer=!1}eq(e){return e.content==this.content&&e.options.streaming===this.options.streaming}get lineBreaks(){return(this.content.match(/\n/g)||"").length}updateDOM(e,t){return this._updateDOM(e),!0}get content(){return this.options.content}toDOM(){let e=document.createElement("span");return this.options.onPointerOver&&e.addEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.addEventListener("pointerleave",this.options.onPointerLeave),e.classList.add("jp-GhostText"),e.dataset.animation=f.streamingAnimation,e.dataset.providedBy=this.options.providerId,this._updateDOM(e),e}_updateDOM(e){const t=this.content;let i=this.options.addedPart;if(i&&!this.isSpacer){i.startsWith("\n")&&(i=i.substring(1)),e.innerText=t.substring(0,t.length-i.length);const n=document.createElement("span");n.className="jp-GhostText-streamedToken",n.innerText=i,e.appendChild(n)}else e.innerText=t;if(!this.isSpacer&&this.options.streaming){const t=document.createElement("span");t.className="jp-GhostText-streamingIndicator",e.appendChild(t)}}destroy(e){this.options.onPointerOver&&e.removeEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.removeEventListener("pointerleave",this.options.onPointerLeave),super.destroy(e)}}class C extends w{constructor(){super(...arguments),this.isSpacer=!0}}class y extends C{toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-lineSpacer"),e}}class P extends C{get content(){return this.options.content[0]}toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-letterSpacer"),e}}!function(e){let t;function i(e,t){return g.p.widget({widget:new w(e),side:1,ghostSpec:e}).range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))}!function(e){e[e.Set=0]="Set",e[e.Remove=1]="Remove",e[e.FilterAndUpdate=2]="FilterAndUpdate"}(t||(t={})),e.addMark=_.Py.define({map:(e,t)=>({...e,from:t.mapPos(e.from),to:t.mapPos(e.from+e.content.length)})}),e.removeMark=_.Py.define(),e.markField=_.QQ.define({create:()=>g.p.none,update(n,s){const o=function(i){for(let n of i.effects){if(n.is(e.addMark))return{action:t.Set,spec:n.value};if(n.is(e.removeMark))return{action:t.Remove}}return i.docChanged||i.selection?{action:t.FilterAndUpdate}:null}(s);if(n=n.update({filter:(e,t,i)=>!(i.spec.widget instanceof C&&i.spec.timeoutInfo.elapsed)}),!o)return n.map(s.changes);switch(o.action){case t.Set:{const e=i(o.spec,s);return n.update({add:[e],filter:(t,i,n)=>n===e.value})}case t.Remove:return n.update({filter:()=>!1});case t.FilterAndUpdate:{let e=n.iter();for(;e.value&&e.value.spec.widget instanceof C;)e.next();if(!e.value)return n.map(s.changes);const t=e.value.spec.ghostSpec,o={...t};let r=!1;s.changes.iterChanges(((e,t,i,n,s)=>{if(!r)if(e===t&&i!==n)for(let e=0;e<s.lines;e++){const t=s.lineAt(e).text,i=e>0?"\n"+t:t;if(!o.content.startsWith(i)){r=!0;break}o.content=o.content.slice(i.length),o.from+=i.length}else r=!0}));const l=r?function(e,t,i=1e3){if(e.content.length<2)return[];const n={elapsed:!1};setTimeout((()=>{n.elapsed=!0}),i);const s=g.p.widget({widget:new P(e),side:1,timeoutInfo:n}),o=g.p.widget({widget:new y(e),side:1,timeoutInfo:n});return[s.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length)),o.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))]}(t,s):[i(o,s)],a=l.map((e=>e.value));if(n=n.update({add:l,filter:(e,t,i)=>a.includes(i)}),r)try{n=n.map(s.changes)}catch(e){return console.warn(e),g.p.none}return n}}},provide:e=>g.tk.decorations.from(e)})}(u||(u={}));const x="jp-InlineCompleter-hover";class b extends p.$L{constructor(e){var t,i;super({node:document.createElement("div")}),this._clearHoverTimeout=null,this._current=0,this._editor=null,this._lastItem=null,this._model=null,this._providerWidget=new p.$L,this._showShortcuts=b.defaultSettings.showShortcuts,this._showWidget=b.defaultSettings.showWidget,this._suggestionsCounter=new p.$L,this._toolbar=new n.o8,this.model=null!==(t=e.model)&&void 0!==t?t:null,this.editor=null!==(i=e.editor)&&void 0!==i?i:null,this.addClass("jp-InlineCompleter"),this._ghostManager=new f({onBlur:this._onEditorBlur.bind(this)}),this._trans=e.trans;const s=this.layout=new p.LN;s.addWidget(this._suggestionsCounter),s.addWidget(this.toolbar),s.addWidget(this._providerWidget),this._progressBar=document.createElement("div"),this._progressBar.className="jp-InlineCompleter-progressBar",this.node.appendChild(this._progressBar),this._updateShortcutsVisibility(),this._updateDisplay(),this.node.tabIndex=0}get toolbar(){return this._toolbar}get editor(){return this._editor}set editor(e){var t;null===(t=this.model)||void 0===t||t.reset(),this._editor=e}get model(){return this._model}set model(e){(e||this._model)&&e!==this._model&&(this._model&&(this._model.suggestionsChanged.disconnect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.disconnect(this._onModelFilterTextChanged,this),this._model.provisionProgress.disconnect(this._onProvisionProgress,this)),this._model=e,this._model&&(this._model.suggestionsChanged.connect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.connect(this._onModelFilterTextChanged,this),this._model.provisionProgress.connect(this._onProvisionProgress,this)))}cycle(e){var t,i;const n=null===(i=null===(t=this.model)||void 0===t?void 0:t.completions)||void 0===i?void 0:i.items;if(n){if("next"===e){const e=this._current+1;this._current=e===n.length?0:e}else{const e=this._current-1;this._current=-1===e?n.length-1:e}this._updateStreamTracking(),this._render()}}accept(){const e=this.model,t=this.current,i=this._editor;if(!i||!e||!t)return;const n=e.cursor,s=t.insertText,o=i.getOffsetAt(i.getCursorPosition()),r=i.getOffsetAt(n),l=r,a=o;i.model.sharedModel.updateSource(r,o,s),o<=a&&o>=l&&i.setCursorPosition(i.getPositionAt(l+s.length)),e.reset(),this.update()}get current(){var e;const t=null===(e=this.model)||void 0===e?void 0:e.completions;return t?t.items[this._current]:null}_updateStreamTracking(){this._lastItem&&this._lastItem.stream.disconnect(this._onStream,this);const e=this.current;e&&e.stream.connect(this._onStream,this),this._lastItem=e}_onStream(e,t){var i;const n=null===(i=this.model)||void 0===i?void 0:i.completions;if(!n||!n.items||0===n.items.length)return;if(this.isHidden)return;const s=n.items[this._current];this._setText(s)}configure(e){this._showWidget=e.showWidget,this._updateDisplay(),e.showShortcuts!==this._showShortcuts&&(this._showShortcuts=e.showShortcuts,this._updateShortcutsVisibility()),f.streamingAnimation=e.streamingAnimation}handleEvent(e){if(!this.isHidden&&this._editor)switch(e.type){case"pointerdown":this._evtPointerdown(e);break;case"scroll":this._evtScroll(e)}}onUpdateRequest(e){super.onUpdateRequest(e);const t=this._model;if(!t)return;let i=t.completions;i&&i.items&&0!==i.items.length?this.isHidden&&(this.show(),this._setGeometry()):this.isHidden||this.hide()}onAfterAttach(e){document.addEventListener("scroll",this,!0),document.addEventListener("pointerdown",this,!0)}onBeforeDetach(e){document.removeEventListener("scroll",this,!0),document.removeEventListener("pointerdown",this,!0)}_evtPointerdown(e){var t;if(this.isHidden||!this._editor)return;const i=e.target;if(this.node.contains(i))return!0;this.hide(),null===(t=this.model)||void 0===t||t.reset()}_evtScroll(e){if(this.isHidden||!this._editor)return;const{node:t}=this;t.contains(e.target)||requestAnimationFrame((()=>{this._setGeometry()}))}_onEditorBlur(e){if(this.node.contains(e.relatedTarget))return!1;this.hide()}_onModelSuggestionsChanged(e,t){var i;if(this.isAttached){if("set"===t.event)this._current=null!==(i=t.indexMap.get(this._current))&&void 0!==i?i:0;else if("clear"===t.event){const e=this.editor;e&&this._ghostManager.clearGhosts(e.editor)}this._updateStreamTracking(),this.update(),this._render()}else this.update()}_onModelFilterTextChanged(e,t){var i,n;const s=null===(i=this.model)||void 0===i?void 0:i.completions;s&&s.items&&0!==s.items.length&&(this._current=null!==(n=t.get(this._current))&&void 0!==n?n:0,this._updateStreamTracking(),setTimeout((()=>{this._render(),this._setGeometry()}),0))}_onProvisionProgress(e,t){requestAnimationFrame((()=>{0===t.pendingProviders?this._progressBar.style.display="none":(this._progressBar.style.display="",this._progressBar.style.width=100*t.pendingProviders/t.totalProviders+"%")}))}_render(){var e,t;const i=null===(e=this.model)||void 0===e?void 0:e.completions;if(!i||!i.items||0===i.items.length)return;const n=i.items[this._current];this._setText(n),"never"!==this._showWidget&&(this._suggestionsCounter.node.innerText=this._trans.__("%1/%2",this._current+1,i.items.length),this._providerWidget.node.title=this._trans.__("Provider: %1",n.provider.name),(null!==(t=n.provider.icon)&&void 0!==t?t:c.Ec).render(this._providerWidget.node))}_setText(e){const t=e.insertText,i=this._editor,n=this._model;if(!n||!i)return;const s=i.editor;this._ghostManager.placeGhost(s,{from:i.getOffsetAt(n.cursor),content:t,providerId:e.provider.identifier,addedPart:e.lastStreamed,streaming:e.streaming,onPointerOver:this._onPointerOverGhost.bind(this),onPointerLeave:this._onPointerLeaveGhost.bind(this)})}_onPointerOverGhost(){null!==this._clearHoverTimeout&&(window.clearTimeout(this._clearHoverTimeout),this._clearHoverTimeout=null),this.node.classList.add(x)}_onPointerLeaveGhost(){this._clearHoverTimeout=window.setTimeout((()=>this.node.classList.remove(x)),500)}_setGeometry(){const{node:e}=this,t=this._model,i=this._editor;if(!i||!t||!t.cursor)return;const n=i.host.closest(".jp-MainAreaWidget > .lm-Widget")||i.host;let s;try{s=i.getCoordinateForPosition(t.cursor)}catch(e){return void this.hide()}v.Y.setGeometry({anchor:s,host:n,maxHeight:40,minHeight:20,node:e,privilege:"forceAbove",outOfViewDisplay:{top:"stick-outside",bottom:"stick-inside",left:"stick-inside",right:"stick-outside"}})}_updateShortcutsVisibility(){this.node.dataset.showShortcuts=this._showShortcuts+""}_updateDisplay(){this.node.dataset.display=this._showWidget}}!function(e){e.defaultSettings={showWidget:"onHover",showShortcuts:!0,streamingAnimation:"uncover",providers:{}},e.Model=class{constructor(){this.suggestionsChanged=new m.Signal(this),this.filterTextChanged=new m.Signal(this),this.provisionProgress=new m.Signal(this),this._isDisposed=!1,this._completions=null}setCompletions(e){var t,i;const n=new Map(null===(i=null===(t=this._completions)||void 0===t?void 0:t.items)||void 0===i?void 0:i.map(((e,t)=>[e.insertText,t])));this._completions=e;const s=new Map(e.items.map(((e,t)=>[n.get(e.insertText),t])));this.suggestionsChanged.emit({event:"set",indexMap:s})}appendCompletions(e){this._completions&&this._completions.items?(this._completions.items.push(...e.items),this.suggestionsChanged.emit({event:"append"})):console.warn("No completions to append to")}notifyProgress(e){this.provisionProgress.emit(e)}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get completions(){return this._completions}reset(){this._completions=null,this.suggestionsChanged.emit({event:"clear"})}get isDisposed(){return this._isDisposed}handleTextChange(e){var t;const i=this._completions;if(!i||!i.items||0===i.items.length)return;const n=new Map(i.items.map(((e,t)=>[e,t])));for(let n of null!==(t=e.sourceChange)&&void 0!==t?t:[]){const e=n.insert;if(e){const t=i.items.filter((t=>{var i;const n=null!==(i=t.filterText)&&void 0!==i?i:t.insertText;return!!n.startsWith(e)&&(t.filterText=n.substring(e.length),t.insertText=t.insertText.substring(e.length),!0)}));0===t.length&&(this._completions=null),i.items=t}else n.retain||(this._completions=null)}const s=new Map(i.items.map(((e,t)=>[n.get(e),t])));this.filterTextChanged.emit(s)}handleSelectionChange(e){const t=this.cursor;if(!t)return;const{start:i,end:n}=e;i.column===n.column&&i.line===n.line||this.reset(),(i.line!==t.line||i.column<t.column)&&this.reset()}dispose(){this._isDisposed||(this._isDisposed=!0,m.Signal.clearData(this))}}}(b||(b={}));var S=i(30102),T=i(2585),k=i(39265),M=i(44066);class I{constructor(){this._activeProviders=new Set([a.R,o]),this._inlineCompleterSettings=b.defaultSettings,this._providers=new Map,this._inlineProviders=new Map,this._panelHandlers=new Map,this._mostRecentContext=new Map,this._activeProvidersChanged=new m.Signal(this),this._inlineCompleterFactory=null}get activeProvidersChanged(){return this._activeProvidersChanged}setTimeout(e){this._timeout=e}setShowDocumentationPanel(e){this._panelHandlers.forEach((t=>t.completer.showDocsPanel=e)),this._showDoc=e}setContinuousHinting(e){this._panelHandlers.forEach((t=>t.autoCompletion=e)),this._autoCompletion=e}registerProvider(e){const t=e.identifier;this._providers.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._providers.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}registerInlineProvider(e){const t=e.identifier;this._inlineProviders.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._inlineProviders.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}getProviders(){return this._providers}activateProvider(e){this._activeProviders=new Set([]),e.forEach((e=>{this._providers.has(e)&&this._activeProviders.add(e)})),0===this._activeProviders.size&&(this._activeProviders.add(a.R),this._activeProviders.add(o)),this._activeProvidersChanged.emit()}async updateCompleter(e){var t,i;const{widget:n,editor:s,sanitizer:o}=e,r=n.id,l=this._panelHandlers.get(r),a=[...this._activeProviders][0],d=this._providers.get(a);let c=null!==(t=null==d?void 0:d.renderer)&&void 0!==t?t:M.X.getDefaultRenderer(o);const h=null==d?void 0:d.modelFactory;let u;u=h?await h.call(d,e):new k.B,this._mostRecentContext.set(n.id,e);const p={model:u,editor:s,renderer:c,sanitizer:o,showDoc:this._showDoc};if(l){const t=l.completer;null===(i=t.model)||void 0===i||i.dispose(),t.model=p.model,t.renderer=p.renderer,t.showDocsPanel=p.showDoc,l.autoCompletion=this._autoCompletion,s&&(l.editor=s,l.reconciliator=await this.generateReconciliator(e))}else{const t=await this._generateHandler(e,p);this._panelHandlers.set(n.id,t),n.disposed.connect((e=>{this.disposeHandler(e.id,t),this._mostRecentContext.delete(r)}))}}invoke(e){const t=this._panelHandlers.get(e);t&&t.invoke()}select(e){const t=this._panelHandlers.get(e);t&&t.completer.selectActive()}setInlineCompleterFactory(e){this._inlineCompleterFactory=e,this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})),this.inline||(this.inline={invoke:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.invokeInline()},cycle:(e,t)=>{const i=this._panelHandlers.get(e);i&&i.inlineCompleter&&i.inlineCompleter.cycle(t)},accept:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.inlineCompleter.accept()},configure:e=>{this._inlineCompleterSettings=e,this._panelHandlers.forEach(((t,i)=>{for(const[t,i]of this._inlineProviders.entries())i.configure&&i.configure(e.providers[t]);t.inlineCompleter&&t.inlineCompleter.configure(e),this.updateCompleter(this._mostRecentContext.get(i))}))}})}get inlineProviders(){return[...this._inlineProviders.values()]}async generateReconciliator(e){const t=[];for(const[e,i]of Object.entries(this._inlineCompleterSettings.providers))!0===i.enabled&&t.push(e);const i=[...this._inlineProviders.values()].filter((e=>t.includes(e.identifier))),n=[];for(const e of this._activeProviders){const t=this._providers.get(e);t&&n.push(t)}return new S.K({context:e,providers:n,inlineProviders:i,inlineProvidersSettings:this._inlineCompleterSettings.providers,timeout:this._timeout})}disposeHandler(e,t){var i,n,s,o;null===(i=t.completer.model)||void 0===i||i.dispose(),t.completer.dispose(),null===(s=null===(n=t.inlineCompleter)||void 0===n?void 0:n.model)||void 0===s||s.dispose(),null===(o=t.inlineCompleter)||void 0===o||o.dispose(),t.dispose(),this._panelHandlers.delete(e)}async _generateHandler(e,t){const i=new M.X(t),n=this._inlineCompleterFactory?this._inlineCompleterFactory.factory({...t,model:new b.Model}):void 0;i.hide(),p.$L.attach(i,document.body),n&&(p.$L.attach(n,document.body),n.hide(),n.configure(this._inlineCompleterSettings));const s=await this.generateReconciliator(e),o=new T._({completer:i,inlineCompleter:n,reconciliator:s});return o.editor=e.editor,o}}var E=i(83375),D=i(34928),H=i(30148),A=i(16909);const j="availableProviders";function L(e){const{schema:t}=e,i=t.title,n=t.description,s=e.formContext.settings,o=s.get(j).user,r={...t.default};if(o)for(const e of Object.keys(r))r[e]=e in o?o[e]:-1;const[l,a]=(0,A.useState)(r);return A.createElement("div",null,A.createElement("fieldset",null,A.createElement("legend",null,i),A.createElement("p",{className:"field-description"},n),Object.keys(r).map((e=>A.createElement("div",{key:e,className:"form-group small-field"},A.createElement("div",null,A.createElement("h3",null," ",e),A.createElement("div",{className:"inputFieldWrapper"},A.createElement("input",{className:"form-control",type:"number",value:l[e],onChange:t=>{((e,t)=>{const i={...l,[e]:parseInt(t.target.value)};s.set(j,i).catch(console.error),a(i)})(e,t)}}))))))))}const O="@jupyterlab/completer-extension:manager",W="@jupyterlab/completer-extension:inline-completer";var R;!function(e){e.nextInline="inline-completer:next",e.previousInline="inline-completer:previous",e.acceptInline="inline-completer:accept",e.invokeInline="inline-completer:invoke"}(R||(R={}));const F={id:"@jupyterlab/completer-extension:base-service",description:"Adds context and kernel completion providers.",requires:[s.pl],autoStart:!0,activate:(e,t)=>{t.registerProvider(new r),t.registerProvider(new a.D)}},G={id:"@jupyterlab/completer-extension:inline-history",description:"Adds inline completion provider suggesting code from execution history.",requires:[s.pl],optional:[d.gv],autoStart:!0,activate:(e,t,i)=>{t.registerInlineProvider(new h({translator:null!=i?i:d.Sr}))}},B={id:"@jupyterlab/completer-extension:inline-completer-factory",description:"Provides a factory for inline completer.",provides:s.zp,optional:[d.gv],autoStart:!0,activate:(e,t)=>{const i=(t||d.Sr).load("jupyterlab");return{factory:t=>{const s=new b({...t,trans:i}),o=t=>{const i=e.commands.keyBindings.find((e=>e.command===t)),n=i?H.H.formatKeystroke(i.keys):"";return n?`${n}`:""};return s.toolbar.addItem("previous-inline-completion",new n.oR({commands:e.commands,icon:c.Co,id:R.previousInline,label:o(R.previousInline),caption:i.__("Previous")})),s.toolbar.addItem("next-inline-completion",new n.oR({commands:e.commands,icon:c.dz,id:R.nextInline,label:o(R.nextInline),caption:i.__("Next")})),s.toolbar.addItem("accept-inline-completion",new n.oR({commands:e.commands,icon:c.eQ,id:R.acceptInline,label:o(R.acceptInline),caption:i.__("Accept")})),s}}}},q={id:W,description:"Provides a factory for inline completer.",requires:[s.pl,s.zp,E.O],optional:[d.gv],autoStart:!0,activate:(e,t,i,n,s)=>{t.setInlineCompleterFactory(i);const o=(s||d.Sr).load("jupyterlab"),r=()=>!!e.shell.currentWidget&&!!t.inline;e.commands.addCommand(R.nextInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"next")},label:o.__("Next Inline Completion"),isEnabled:r}),e.commands.addCommand(R.previousInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"previous")},label:o.__("Previous Inline Completion"),isEnabled:r}),e.commands.addCommand(R.acceptInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.accept(e.shell.currentWidget.id)},label:o.__("Accept Inline Completion"),isEnabled:r}),e.commands.addCommand(R.invokeInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.invoke(e.shell.currentWidget.id)},label:o.__("Invoke Inline Completer"),isEnabled:r});const l=e=>{var i;null===(i=t.inline)||void 0===i||i.configure(e.composite)};e.restored.then((()=>{var e;const i=null!==(e=t.inlineProviders)&&void 0!==e?e:[],s=e=>{var t,i;return{enabled:!0,timeout:5e3,debouncerDelay:0,...null!==(i=null===(t=e.schema)||void 0===t?void 0:t.default)&&void 0!==i?i:{}}};n.transform(W,{compose:e=>{var t,n;const o=null!==(t=e.data.composite.providers)&&void 0!==t?t:{};for(const e of i){const t=s(e);o[e.identifier]={...t,...null!==(n=o[e.identifier])&&void 0!==n?n:{}}}return e.data.composite.providers=o,e},fetch:e=>{var t,n;const r=e.schema.properties,l={};for(const e of i)l[e.identifier]={title:o.__("%1 provider",e.name),properties:{...null!==(n=null===(t=e.schema)||void 0===t?void 0:t.properties)&&void 0!==n?n:{},timeout:{title:o.__("Timeout"),description:o.__("Timeout for %1 provider (in milliseconds).",e.name),type:"number",minimum:0},debouncerDelay:{title:o.__("Debouncer delay"),minimum:0,description:o.__("Time since the last key press to wait before requesting completions from %1 provider (in milliseconds).",e.name),type:"number"},enabled:{title:o.__("Enabled"),description:o.__("Whether to fetch completions %1 provider.",e.name),type:"boolean"}},default:s(e),type:"object"};return r.providers.properties=l,e}}),n.load(W).then((e=>{l(e),e.changed.connect((e=>{l(e)}))})).catch(console.error)})).catch(console.error)}},N={id:O,description:"Provides the completion provider manager.",requires:[E.O],optional:[D.C],provides:s.pl,autoStart:!0,activate:(e,t,i)=>{const n="availableProviders",s=new I,o=(e,t)=>{var i;const o=e.get(n),r=e.get("providerTimeout"),l=e.get("showDocumentationPanel"),a=e.get("autoCompletion");s.setTimeout(r.composite),s.setShowDocumentationPanel(l.composite),s.setContinuousHinting(a.composite);const d=null!==(i=o.user)&&void 0!==i?i:o.composite,c=Object.entries(null!=d?d:{}).filter((e=>e[1]>=0&&t.includes(e[0]))).sort((([,e],[,t])=>t-e)).map((e=>e[0]));s.activateProvider(c)};if(e.restored.then((()=>{const e=[...s.getProviders().entries()],i=e.map((([e,t])=>e));t.transform(O,{fetch:t=>{const i=t.schema.properties,s={};return e.forEach((([e,t],i)=>{var n;s[e]=null!==(n=t.rank)&&void 0!==n?n:10*(i+1)})),i[n].default=s,t}}),t.load(O).then((e=>{o(e,i),e.changed.connect((e=>{o(e,i)}))})).catch(console.error)})).catch(console.error),i){const e={fieldRenderer:e=>L(e)};i.addRenderer(`${O}.availableProviders`,e)}return s}},$=[N,F,G,B,q]},34928:(e,t,i)=>{i.d(t,{C:()=>s,E:()=>o});var n=i(16982);const s=new n.Token("@jupyterlab/ui-components:IFormRendererRegistry","A service for settings form renderer registration."),o=new n.Token("@jupyterlab/ui-components:ILabIconManager","A service to register and request icons.")}}]);