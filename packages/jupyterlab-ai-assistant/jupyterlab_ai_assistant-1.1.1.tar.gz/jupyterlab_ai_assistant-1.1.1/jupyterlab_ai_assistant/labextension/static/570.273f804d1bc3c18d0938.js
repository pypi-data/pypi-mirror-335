"use strict";(self.webpackChunkjupyterlab_ai_assistant=self.webpackChunkjupyterlab_ai_assistant||[]).push([[570],{1144:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e"},1942:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(1601),a=n.n(o),l=n(6314),r=n.n(l)()(a());r.push([e.id,'/* Chat Widget Base Styles */\n.jp-AI-ChatWidget {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  font-family: var(--jp-ui-font-family);\n  background-color: var(--jp-layout-color1);\n}\n\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  max-width: 100%;\n  background-color: var(--jp-layout-color1);\n}\n\n/* Header Styles */\n.chat-header {\n  background-color: var(--jp-layout-color2);\n  border-bottom: 1px solid var(--jp-border-color2);\n}\n\n.chat-header h3 {\n  color: var(--jp-ui-font-color1);\n  font-size: 1rem;\n  font-weight: 600;\n}\n\n/* Context Section */\n.context-section {\n  background-color: var(--jp-layout-color2);\n}\n\n.context-code {\n  background-color: var(--jp-layout-color3);\n  font-family: var(--jp-code-font-family);\n  font-size: var(--jp-code-font-size);\n  color: var(--jp-content-font-color1);\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n/* Messages Container */\n.messages-container {\n  flex: 1;\n  overflow-y: auto;\n  background-color: var(--jp-layout-color1);\n}\n\n.messages-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n/* Message Styles */\n.message-wrapper {\n  max-width: 85%;\n  margin: 0.5rem 0;\n}\n\n@media (max-width: 768px) {\n  .message-wrapper {\n    max-width: 90%;\n  }\n}\n\n.message-bubble {\n  background-color: var(--jp-layout-color2);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.user-message .message-bubble {\n  background-color: var(--jp-brand-color1);\n  color: white;\n}\n\n.assistant-message .message-bubble {\n  background-color: var(--jp-layout-color2);\n  color: var(--jp-content-font-color1);\n}\n\n/* Code Block Styles */\n.code-block-wrapper {\n  width: 100%;\n  overflow-x: auto;\n}\n\n.code-block-wrapper pre {\n  margin: 0;\n  font-family: var(--jp-code-font-family);\n  font-size: var(--jp-code-font-size);\n}\n\n.dark-theme .code-block-wrapper pre.bg-dark {\n  background-color: #1e1e1e !important;\n  color: #d4d4d4;\n}\n\n.light-theme .code-block-wrapper pre.bg-light {\n  background-color: #f8f9fa !important;\n  color: #212529;\n}\n\n/* Input Section */\n.input-section {\n  background-color: var(--jp-layout-color2);\n  border-top: 1px solid var(--jp-border-color2);\n}\n\n.input-section textarea {\n  background-color: var(--jp-layout-color1);\n  color: var(--jp-content-font-color1);\n  border: 1px solid var(--jp-border-color1);\n  font-family: var(--jp-ui-font-family);\n  font-size: 0.9rem;\n  resize: none;\n}\n\n.input-section textarea:focus {\n  border-color: var(--jp-brand-color1);\n  box-shadow: 0 0 0 0.2rem rgba(var(--jp-brand-color1), 0.25);\n}\n\n.input-section button {\n  height: 100%;\n  min-height: 38px;\n}\n\n/* Model Selector */\n.model-selector {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.model-selector label {\n  color: var(--jp-ui-font-color1);\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n\n.model-select {\n  background-color: var(--jp-layout-color1);\n  color: var(--jp-content-font-color1);\n  border: 1px solid var(--jp-border-color1);\n  border-radius: 4px;\n  padding: 0.375rem 0.75rem;\n  font-size: 0.9rem;\n  max-width: 200px;\n}\n\n/* Responsive Design */\n@media (max-width: 576px) {\n  .chat-header {\n    padding: 0.5rem !important;\n  }\n\n  .chat-header h3 {\n    font-size: 0.9rem;\n  }\n\n  .model-selector {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.25rem;\n  }\n\n  .model-select {\n    width: 100%;\n    max-width: none;\n  }\n\n  .message-wrapper {\n    max-width: 95%;\n  }\n\n  .input-section {\n    padding: 0.5rem !important;\n  }\n\n  .input-section textarea {\n    font-size: 0.9rem;\n    min-height: 60px;\n  }\n}\n\n/* Dark Theme Adjustments */\n.dark-theme {\n  background-color: var(--jp-layout-color0);\n}\n\n.dark-theme .message-bubble {\n  background-color: var(--jp-layout-color2);\n}\n\n.dark-theme .user-message .message-bubble {\n  background-color: #2a66d9;\n}\n\n.dark-theme code {\n  background-color: var(--jp-layout-color3);\n}\n\n/* Light Theme Adjustments */\n.light-theme .message-bubble {\n  background-color: var(--jp-layout-color2);\n}\n\n.light-theme .user-message .message-bubble {\n  background-color: #4285f4;\n}\n\n.light-theme code {\n  background-color: var(--jp-layout-color3);\n}\n\n/* Cell Context Menu Styles */\n.cell-context-menu {\n  position: absolute;\n  z-index: 1000;\n  min-width: 600px;\n  max-width: 800px;\n  width: 70%;\n  max-height: 85vh;\n  border-radius: 10px;\n  background-color: var(--jp-layout-color1);\n  box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.3) !important;\n  border: 1px solid var(--jp-border-color1);\n  overflow: hidden;\n  transform: translateY(0) scale(1);\n  opacity: 0;\n  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n}\n\n/* Animation classes */\n.cell-context-menu.animate-in {\n  opacity: 1;\n  transform: translateY(0) scale(1);\n}\n\n.cell-context-menu.animate-out {\n  opacity: 0;\n  transform: translateY(10px) scale(0.95);\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .cell-context-menu {\n    min-width: 400px;\n    width: 90%;\n    max-height: 90vh;\n  }\n}\n\n/* Make sure the card body can scroll if needed */\n.cell-context-menu .card-body {\n  max-height: 70vh;\n  overflow-y: auto;\n  padding: 1.5rem;\n}\n\n/* Enhance code blocks */\n.cell-context-menu pre {\n  background-color: var(--jp-layout-color2);\n  border-radius: 6px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  border: 1px solid var(--jp-border-color2);\n  font-size: 14px;\n  line-height: 1.5;\n  overflow-x: auto;\n  max-height: 250px;\n}\n\n/* Style inline code */\n.cell-context-menu code {\n  padding: 0.2em 0.4em;\n  border-radius: 3px;\n  font-size: 90%;\n}\n\n.cell-context-menu .card-header {\n  padding: 1rem 1.5rem;\n  border-bottom: 2px solid var(--jp-border-color2);\n  background-color: var(--jp-layout-color2);\n}\n\n/* Enhance alert styling */\n.cell-context-menu .alert {\n  border-radius: 6px;\n  padding: 1rem 1.25rem;\n  margin-bottom: 1.5rem;\n}\n\n/* Enhance result card */\n.cell-context-menu .result-card {\n  border: 1px solid var(--jp-brand-color1);\n  border-radius: 8px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  margin-top: 1.5rem;\n}\n\n.cell-context-menu .result-card .card-header {\n  background-color: rgba(var(--jp-brand-color1), 0.1);\n  border-bottom: 1px solid var(--jp-brand-color1);\n  padding: 0.75rem 1.25rem;\n}\n\n.cell-context-menu .response-content {\n  padding: 1.25rem;\n  line-height: 1.6;\n  font-size: 15px;\n}\n\n/* Better typography */\n.cell-context-menu .card-body p {\n  margin-bottom: 1rem;\n  line-height: 1.6;\n}\n\n.cell-context-menu .badge {\n  font-size: 85%;\n  padding: 0.35em 0.65em;\n  font-weight: 600;\n}\n\n/* For dark themes */\nbody[data-jp-theme-light="false"] .cell-context-menu .bg-light {\n  background-color: var(--jp-layout-color2) !important;\n}\n\nbody[data-jp-theme-light="false"] .cell-context-menu .text-muted {\n  color: var(--jp-ui-font-color2) !important;\n}\n\n/* Additional Bootstrap enhancements */\n.cell-context-menu .btn-close {\n  padding: 0.5rem;\n  margin: -0.5rem -0.5rem -0.5rem auto;\n}\n\n.cell-context-menu .code-block-wrapper pre.bg-light {\n  background-color: var(--jp-layout-color2) !important;\n}\n\n/* Ensure table styling is nice in markdown */\n.cell-context-menu table {\n  width: 100%;\n  margin-bottom: 1rem;\n  border-collapse: collapse;\n}\n\n.cell-context-menu table th,\n.cell-context-menu table td {\n  padding: 0.5rem;\n  border: 1px solid var(--jp-border-color2);\n}\n\n.cell-context-menu table th {\n  background-color: var(--jp-layout-color2);\n  font-weight: bold;\n}\n\n/* Nice transitions for interactive elements */\n.cell-context-menu .btn,\n.cell-context-menu .alert,\n.cell-context-menu .badge {\n  transition: all 0.2s ease-in-out;\n}\n\n/* Add styles for dashed border placeholder */\n.border-dashed {\n  border: 2px dashed var(--jp-border-color2) !important;\n  background-color: var(--jp-layout-color0) !important;\n}\n\n/* Style the action buttons */\n.cell-context-menu .btn.btn-action {\n  padding: 0.5rem 1rem;\n  border-radius: 8px;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  border: none;\n  margin: 0.25rem;\n  transition: all 0.3s ease;\n  animation: fadeInUp 0.5s ease forwards;\n  opacity: 0;\n  transform: translateY(10px);\n}\n\n.cell-context-menu .btn.btn-action:hover {\n  transform: translateY(-2px) !important;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;\n}\n\n.cell-context-menu .btn.btn-action:active {\n  transform: translateY(0) !important;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1) !important;\n}\n\n/* Button hover effects */\n.cell-context-menu .btn:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n/* Add styling for code blocks within markdown responses */\n.code-block-wrapper {\n  background-color: var(--jp-layout-color2);\n  border-radius: 8px;\n  margin: 1rem 0;\n  position: relative;\n  overflow: hidden;\n}\n\n.code-block-wrapper pre {\n  margin: 0;\n  padding: 1rem;\n  overflow-x: auto;\n  font-size: 0.9rem;\n  line-height: 1.5;\n  background-color: var(--jp-layout-color2);\n  border-radius: 8px;\n}\n\n/* Code section in the dialog */\n.code-section pre {\n  max-height: 200px;\n  font-size: 0.85rem;\n  background-color: var(--jp-layout-color0);\n  border: 1px solid var(--jp-border-color1);\n  margin: 0;\n  border-radius: 0 0 8px 8px !important;\n}\n\n/* Result card styling */\n.result-card {\n  transition: all 0.3s ease;\n  animation: fadeInUp 0.5s ease;\n}\n\n/* Enhanced spinner styles */\n.spinner-grow {\n  opacity: 0.7;\n}\n\n/* Ensure proper light/dark theme adaptation */\nbody[data-jp-theme-light="true"] .cell-context-menu .card-body {\n  color: var(--jp-ui-font-color1);\n}\n\nbody[data-jp-theme-light="false"] .cell-context-menu .card-body {\n  color: var(--jp-ui-font-color1);\n}\n\nbody[data-jp-theme-light="false"] .cell-context-menu .bg-light {\n  background-color: var(--jp-layout-color2) !important;\n}\n\nbody[data-jp-theme-light="false"] .cell-context-menu .text-muted {\n  color: var(--jp-ui-font-color3) !important;\n}\n\nbody[data-jp-theme-light="false"] .cell-context-menu code.bg-light {\n  background-color: var(--jp-layout-color3) !important;\n}\n\n/* Animations */\n@keyframes fadeInScale {\n  from { \n    opacity: 0; \n    transform: scale(0.95);\n  }\n  to { \n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* Card header styling */\n.cell-context-menu .card-header {\n  padding: 0.75rem 1rem;\n  font-weight: bold;\n}\n\n/* Card body enhanced spacing */\n.cell-context-menu .card-body {\n  padding: 1.25rem;\n}\n\n/* Improved alert styling */\n.cell-context-menu .alert {\n  border-radius: 8px;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\n}\n\n/* Improved code styling */\n.cell-context-menu pre,\n.cell-context-menu code {\n  border-radius: 6px;\n  font-family: \'JetBrains Mono\', \'Fira Code\', \'Source Code Pro\', monospace, var(--jp-code-font-family);\n} ',""]);const s=r},2247:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%2833, 37, 41, 0.75%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},3385:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e"},4274:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e"},4718:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e"},5372:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e"},5419:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27m6 10 3 3 6-6%27/%3e%3c/svg%3e"},5531:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},5782:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e"},5932:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e"},6366:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e"},6690:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%236ea8fe%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e"},6904:(e,t,n)=>{n.r(t),n.d(t,{ChatWidget:()=>M,OllamaTestComponent:()=>h,analyzeCellContent:()=>p,createOllamaTestWidget:()=>b,default:()=>_,getAvailableModels:()=>g,requestAPI:()=>m,sendChatMessage:()=>u});var o=n(3345),a=n.n(o),l=n(4120),r=n(5256),s=n(7628),c=n.n(s),i=n(4979),d=n(6916);async function m(e="",t={}){const n=d.ServerConnection.makeSettings(),o=i.URLExt.join(n.baseUrl,"api","ollama",e);if(console.log(`[DEBUG] Making ${t.method||"GET"} request to: ${o}`),t.body)try{const e=JSON.parse(t.body);console.log("[DEBUG] Request payload:",JSON.stringify(e,null,2))}catch(e){console.log("[DEBUG] Request body:",t.body)}const a=Date.now();let l;try{console.log(`[DEBUG] Sending request to ${e}...`),l=await d.ServerConnection.makeRequest(o,t,n),console.log(`[DEBUG] Response received in ${Date.now()-a}ms, status: ${l.status}`)}catch(e){throw console.error("[DEBUG] Network error making request:",e),new d.ServerConnection.NetworkError(e)}if(l.ok)try{const e=await l.text();if(console.log(`[DEBUG] Response size: ${e.length} bytes`),!e||""===e.trim())return console.log("[DEBUG] Empty response received"),{};try{const t=JSON.parse(e);return console.log("[DEBUG] Response parsed successfully:",JSON.stringify(t,null,2).substring(0,1e3)+(JSON.stringify(t,null,2).length>1e3?"... (truncated)":"")),t}catch(t){throw console.error("[DEBUG] Error parsing JSON response:",t),console.debug("[DEBUG] Response text (first 500 chars):",e.substring(0,500)),new Error(`Invalid JSON response: ${t.message}`)}}catch(e){throw console.error("[DEBUG] Error processing response:",e),new d.ServerConnection.ResponseError(l,`Failed to process response: ${e.message}`)}try{const e=await l.text();let t;try{t=JSON.parse(e)}catch(t){throw new d.ServerConnection.ResponseError(l,`Server error: ${e.substring(0,200)}`)}throw new d.ServerConnection.ResponseError(l,t.error||`Server error: ${l.status} ${l.statusText}`)}catch(e){if(e instanceof d.ServerConnection.ResponseError)throw e;throw new d.ServerConnection.ResponseError(l,`Unknown error: ${l.status} ${l.statusText}`)}}async function g(){console.log("[DEBUG] Fetching available Ollama models...");try{const e=await m("models");return e.models?(console.log(`[DEBUG] Successfully fetched ${e.models.length} models:`,e.models.map((e=>e.name||e.id||"unknown")).join(", ")),e.models):(console.warn("[DEBUG] No models found in response:",e),[])}catch(e){return console.error("[DEBUG] Error fetching models:",e),[]}}async function u(e,t,n={}){try{return console.log(`Sending chat message to model ${e} with ${t.length} messages`),await m("chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({model:e,messages:t,stream:!1},n))})}catch(e){throw console.error("Error sending chat message:",e),e}}async function p(e,t,n,o){var a;try{console.log("[DEBUG] Starting cell analysis request:"),console.log(`[DEBUG] - Model: ${e}`),console.log(`[DEBUG] - Cell type: ${n}`),console.log(`[DEBUG] - Content length: ${t.length} characters`),console.log(`[DEBUG] - Content preview: ${t.substring(0,100)}${t.length>100?"...":""}`),console.log(`[DEBUG] - Question: ${o}`);const l=Date.now(),r=await m("cell-context",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e,cell_content:t,cell_type:n,question:o})});if(console.log(`[DEBUG] Cell analysis completed in ${Date.now()-l}ms`),!r||"object"!=typeof r)throw console.error("[DEBUG] Invalid response format:",r),new Error("Invalid response format from server");if("error"in r)throw console.error("[DEBUG] Server returned error:",r.error),new Error(r.error);return(null===(a=r.message)||void 0===a?void 0:a.content)?(console.log("[DEBUG] Response content length:",r.message.content.length),console.log("[DEBUG] Response preview:",r.message.content.substring(0,100)+(r.message.content.length>100?"...":""))):console.log("[DEBUG] Response structure:",Object.keys(r).join(", ")),r}catch(a){throw console.error("[DEBUG] Error analyzing cell content:",a),console.error("[DEBUG] Error context:",{model:e,cellType:n,contentLength:t.length,questionType:o}),a}}const h=()=>{const[e,t]=(0,o.useState)([]),[n,l]=(0,o.useState)(!0),[r,s]=(0,o.useState)(null);return(0,o.useEffect)((()=>{(async()=>{try{const e=await g();t(e||[]),l(!1)}catch(e){console.error("Error fetching models:",e),s("Failed to fetch models. Check the console for details."),l(!1)}})()}),[]),n?a().createElement("div",null,"Loading models..."):r?a().createElement("div",{className:"jp-error"},r):a().createElement("div",{className:"jp-OllamaTest"},a().createElement("h2",null,"Available Ollama Models"),e.length>0?a().createElement("ul",null,e.map(((e,t)=>a().createElement("li",{key:t},a().createElement("strong",null,e.name),e.size&&` - Size: ${(e.size/1073741824).toFixed(2)} GB`,e.parameter_size&&` - Parameters: ${e.parameter_size}`)))):a().createElement("p",null,"No models found. Make sure Ollama is running and has models installed."))};function b(){const e=new r.Widget,t=new l.MainAreaWidget({content:e});return t.id="jp-ollama-test",t.title.label="Ollama Models",t.title.closable=!0,c().render(a().createElement(h,null),e.node),t}var v=n(4178),f=n(9395),y=n.n(f);const w=({message:e,isDarkTheme:t})=>{const n="user"===e.role?"user-message":"assistant-message",o="user"===e.role?"align-self-end":"align-self-start",l="user"===e.role?"text-white":"";return a().createElement("div",{className:`message-wrapper mb-3 ${o} ${n}`},a().createElement("div",{className:`message-bubble p-3 rounded ${l}`},a().createElement("div",{className:"message-header d-flex justify-content-between align-items-center mb-2"},a().createElement("span",{className:"message-role fw-bold"},"user"===e.role?"You":"AI Assistant"),a().createElement("span",{className:"message-time small opacity-75"},e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),a().createElement("div",{className:"message-content"},a().createElement(y(),{components:{code(e){var{node:n,inline:o,className:l,children:r}=e,s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n}(e,["node","inline","className","children"]);const c=/language-(\w+)/.exec(l||"");return!o&&c?a().createElement("div",{className:"code-block-wrapper my-2"},a().createElement("pre",{className:"rounded p-3 "+(t?"bg-dark":"bg-light")},a().createElement("code",Object.assign({className:`${l} d-block`},s),String(r).replace(/\n$/,"")))):a().createElement("code",Object.assign({className:"px-1 rounded "+(t?"bg-dark":"bg-light")},s),r)}}},e.content))))},x=({models:e,selectedModel:t,onModelChange:n})=>a().createElement("div",{className:"model-selector d-flex align-items-center"},a().createElement("label",{htmlFor:"model-select",className:"me-2 text-nowrap"},"Model:"),a().createElement("select",{id:"model-select",value:t,onChange:e=>n(e.target.value),className:"form-select form-select-sm"},0===e.length?a().createElement("option",{value:"",disabled:!0},"Loading models..."):e.map((e=>a().createElement("option",{key:e,value:e},e)))));n(6378);var E=n(5072),k=n.n(E),C=n(7825),D=n.n(C),j=n(7659),B=n.n(j),N=n(5056),A=n.n(N),I=n(540),U=n.n(I),G=n(1113),S=n.n(G),z=n(1942),O={};O.styleTagTransform=S(),O.setAttributes=A(),O.insert=B().bind(null,"head"),O.domAPI=D(),O.insertStyleElement=U(),k()(z.A,O),z.A&&z.A.locals&&z.A.locals;class M extends l.ReactWidget{constructor(e){super(),this.themeManager=e.themeManager,this.initialContext=e.initialContext,this.addClass("jp-ChatWidget"),this.title.label="AI Assistant Chat",this.title.closable=!0,this.title.icon=v.userIcon}render(){return a().createElement($,{themeManager:this.themeManager,initialContext:this.initialContext})}}function $({themeManager:e,initialContext:t}){const[n,l]=(0,o.useState)([]),[r,s]=(0,o.useState)(""),[c,i]=(0,o.useState)(!1),[d,m]=(0,o.useState)("llama2"),[p,h]=(0,o.useState)([]),b=(0,o.useRef)(null);(0,o.useEffect)((()=>{(async()=>{try{const e=await g();h(e.map((e=>e.name))),e.length>0&&m(e[0].name)}catch(e){console.error("Failed to fetch models:",e)}})()}),[]),(0,o.useEffect)((()=>{var e;null===(e=b.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]);const v=async()=>{if(!r.trim())return;const e={id:`user-${Date.now()}`,role:"user",content:r,timestamp:new Date};l((t=>[...t,e])),s(""),i(!0);const t=`assistant-${Date.now()}`;l((e=>[...e,{id:t,role:"assistant",content:"...",timestamp:new Date}]));try{const o=n.filter((e=>"system"!==e.role)).concat(e).map((e=>({role:e.role,content:e.content}))),a={role:"system",content:"You are an AI assistant helping with Jupyter notebooks. Be concise and helpful."},r=await u(d,[a,...o]);l((e=>e.map((e=>{var n;return e.id===t?Object.assign(Object.assign({},e),{content:(null===(n=r.message)||void 0===n?void 0:n.content)||"No response",timestamp:new Date}):e}))))}catch(e){console.error("Error sending message:",e),l((e=>e.map((e=>e.id===t?Object.assign(Object.assign({},e),{content:"Error: Failed to get response from AI",timestamp:new Date}):e))))}finally{i(!1)}},f=!!(null==e?void 0:e.theme)&&!1===e.isLight(e.theme);return a().createElement("div",{className:"chat-container container-fluid p-0 "+(f?"dark-theme":"light-theme")},a().createElement("div",{className:"chat-header row m-0 p-3 align-items-center"},a().createElement("div",{className:"col-6"},a().createElement("h3",{className:"mb-0"},"AI Assistant")),a().createElement("div",{className:"col-6"},a().createElement(x,{models:p,selectedModel:d,onModelChange:m}))),t&&a().createElement("div",{className:"context-section p-3 border-bottom"},a().createElement("h5",{className:"mb-2"},"Context:"),a().createElement("pre",{className:"context-code p-2 rounded"},t)),a().createElement("div",{className:"messages-container p-3"},0===n.length?a().createElement("div",{className:"empty-state text-center p-4"},a().createElement("p",{className:"text-muted"},"No messages yet. Start a conversation!")):a().createElement("div",{className:"messages-list"},n.map((e=>a().createElement(w,{key:e.id,message:e,isDarkTheme:f})))),a().createElement("div",{ref:b})),a().createElement("div",{className:"input-section p-3 border-top"},a().createElement("div",{className:"row m-0"},a().createElement("div",{className:"col-9 col-md-10 p-0 pe-2"},a().createElement("textarea",{className:"form-control",value:r,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:"Type your message...",disabled:c,rows:3})),a().createElement("div",{className:"col-3 col-md-2 p-0"},a().createElement("button",{className:"btn btn-primary w-100 h-100",onClick:v,disabled:c||!r.trim()},c?"Sending...":"Send")))))}var T=n(807),R=n(6752),L=n(8131),F=n(9158),P=n(4053),J=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const q=({cell:e,onClose:t,selectedModel:n,initialAction:l})=>{const[r,s]=(0,o.useState)(!1),[c,i]=(0,o.useState)(null),[d,m]=(0,o.useState)(null),[g,u]=(0,o.useState)(null),[h,b]=(0,o.useState)(""),[f,w]=(0,o.useState)(null);(0,o.useEffect)((()=>{if(c){const e=document.querySelector(".result-container");e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}}),[c]),(0,o.useEffect)((()=>{setTimeout((()=>{b("animate-in")}),50)}),[]),(0,o.useEffect)((()=>{if(l){const e={explain:"Explain this code",optimize:"Optimize this code",debug:"Find bugs",chat:"Chat about code"}[l];e&&k(e)}}),[l]);const x=()=>{try{const t=e.model.sharedModel.getSource();return console.log(`[DEBUG] Retrieved cell content (${t.length} chars)`),t}catch(e){return console.error("[DEBUG] Error getting cell content:",e),m("Failed to retrieve cell content."),""}},E=()=>{try{return"code"===e.model.type?"code":"markdown"}catch(e){return console.error("[DEBUG] Error getting cell type:",e),"unknown"}},k=async e=>{var t;try{w(e),s(!0),i(null),m(null),u(null);const o=x(),a=E();if(!o)return m("Cell content is empty."),void s(!1);console.log(`[DEBUG] Analyzing cell with question: "${e}"`),console.log(`[DEBUG] Cell type: ${a}, model: ${n}`);const l=Date.now(),r=await p(n,o,a,e),c=Date.now();if(u(c-l),r.error)return console.error("[DEBUG] Error from API:",r.error),m(r.error),void s(!1);let d="";d=(null===(t=r.message)||void 0===t?void 0:t.content)?r.message.content:r.response?r.response:"The AI provided no response.",console.log(`[DEBUG] Received response (${d.length} chars)`),i(d)}catch(e){console.error("[DEBUG] Error processing analysis:",e),m(`Error: ${e.message||"Unknown error occurred"}`)}finally{s(!1)}},C=(v.searchIcon,v.buildIcon,v.bugIcon,v.userIcon,x()),D=E();return a().createElement("div",{className:`cell-context-menu card shadow-lg ${h} w-100 max-w-800px mx-auto`},a().createElement("div",{className:"card-header d-flex justify-content-between align-items-center py-3 px-4 border-bottom"},a().createElement("div",null,a().createElement("h5",{className:"m-0 d-flex align-items-center fw-bold"},f&&{"Explain this code":"AI Code Explanation","Optimize this code":"AI Code Optimization","Find bugs":"AI Code Analysis","Chat about code":"AI Chat about Code"}[f]||"AI Assistant",a().createElement("span",{className:"badge bg-primary ms-2"},n))),a().createElement("button",{className:"btn-close",onClick:()=>{b("animate-out"),setTimeout((()=>{t()}),300)},"aria-label":"Close"})),a().createElement("div",{className:"card-body p-4"},a().createElement("div",{className:"code-section mb-4"},a().createElement("h6",{className:"mb-3 fw-bold border-bottom pb-2"},a().createElement("i",{className:"fa fa-code me-2"}),"Cell content (",D,"):"),a().createElement("div",{className:"bg-light rounded border p-3 mb-2 overflow-auto"},((e,t="")=>a().createElement("div",{className:"code-block-wrapper mb-3"},a().createElement("pre",{className:"p-3 rounded border bg-light code-block"},a().createElement("code",{className:t?`language-${t}`:""},e))))(C,"code"===D?"python":"markdown")),a().createElement("div",{className:"d-flex justify-content-end"},a().createElement("small",{className:"text-muted"},C.split("\n").length," lines â€¢ ",C.length," characters"))),r&&a().createElement("div",{className:"alert alert-info d-flex align-items-center shadow-sm mb-4"},a().createElement("div",{className:"spinner-border spinner-border-sm me-3",role:"status"},a().createElement("span",{className:"visually-hidden"},"Loading...")),a().createElement("div",null,a().createElement("strong",null,"Processing with ",n,"..."),a().createElement("div",{className:"text-muted small mt-1"},"This may take a few moments depending on the model and query."))),d&&a().createElement("div",{className:"alert alert-danger shadow-sm mb-4"},a().createElement("h6",{className:"fw-bold alert-heading mb-2"},"Error encountered:"),a().createElement("p",{className:"mb-0"},d)),c&&a().createElement("div",{className:"result-container"},a().createElement("div",{className:"card result-card border-0 shadow-sm"},a().createElement("div",{className:"card-header bg-transparent py-3 px-4 border-bottom"},a().createElement("div",{className:"d-flex justify-content-between align-items-center"},a().createElement("h6",{className:"m-0 fw-bold"},a().createElement("i",{className:"fa fa-robot me-2"}),"AI Response"),g&&a().createElement("span",{className:"badge bg-light text-dark"},"Execution time: ",(g/1e3).toFixed(2),"s"))),a().createElement("div",{className:"card-body response-content px-4 py-3"},a().createElement(y(),{components:{code(e){var{node:t,inline:n,className:o,children:l}=e,r=J(e,["node","inline","className","children"]);const s=/language-(\w+)/.exec(o||"");return!n&&s?a().createElement("div",{className:"code-block-wrapper my-3"},a().createElement("div",{className:"d-flex justify-content-between align-items-center mb-1"},a().createElement("small",{className:"text-muted"},s[1])),a().createElement("pre",{className:"bg-light p-3 rounded border shadow-sm overflow-auto"},a().createElement("code",Object.assign({className:o},r),String(l).replace(/\n$/,"")))):a().createElement("code",Object.assign({className:"bg-light px-2 py-1 rounded"},r),l)},h1:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("h1",Object.assign({className:"border-bottom pb-2 mt-4 mb-3 fs-4"},n))},h2:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("h2",Object.assign({className:"border-bottom pb-2 mt-4 mb-3 fs-5"},n))},h3:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("h3",Object.assign({className:"mt-4 mb-3 fs-6"},n))},table:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("div",{className:"table-responsive my-3"},a().createElement("table",Object.assign({className:"table table-bordered table-sm"},n)))},li:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("li",Object.assign({className:"mb-1"},n))},blockquote:e=>{var{node:t}=e,n=J(e,["node"]);return a().createElement("blockquote",Object.assign({className:"blockquote border-start border-3 ps-3 my-3 text-muted"},n))}}},c))))))},W=(F.INotebookTracker,R.ISettingRegistry,async(e,t,n)=>{var o;console.log("[DEBUG] JupyterLab AI Assistant Cell Toolbar activation starting..."),console.log("[DEBUG] NotebookTracker state:",{hasCurrentWidget:!!t.currentWidget,hasActiveCell:!!(null===(o=t.currentWidget)||void 0===o?void 0:o.content.activeCell),activeCellChangedSignal:!!t.activeCellChanged,currentChangedSignal:!!t.currentChanged,size:t.size});let a="llama2";if(n)try{console.log("[DEBUG] Loading settings from registry..."),a=(await n.load("jupyterlab-ai-assistant:plugin")).get("defaultModel").composite||"llama2",console.log(`[DEBUG] Cell toolbar settings loaded, defaultModel: ${a}`)}catch(e){console.error("[DEBUG] Failed to load cell toolbar settings:",e)}else console.log("[DEBUG] No settings registry available, using default model:",a);let l=[];try{console.log("[DEBUG] Fetching available Ollama models for cell toolbar..."),l=(await g()).map((e=>e.name)),console.log("[DEBUG] Available models for cell toolbar:",l),l.length>0&&!l.includes(a)&&(console.log(`[DEBUG] Default model ${a} not available, switching to ${l[0]}`),a=l[0])}catch(e){console.error("[DEBUG] Failed to fetch Ollama models for cell toolbar:",e)}const r=[{id:"ai-assistant:analyze-cell",icon:v.searchIcon,tooltip:"Explain this code with AI"},{id:"ai-assistant:optimize-cell",icon:v.buildIcon,tooltip:"Optimize this code with AI"},{id:"ai-assistant:debug-cell",icon:v.bugIcon,tooltip:"Debug this code with AI"},{id:"ai-assistant:chat-cell",icon:v.userIcon,tooltip:"Chat about this code"}];console.log("[DEBUG] Cell toolbar command IDs:",r.map((e=>e.id)).join(", "));const s=()=>{const n=!!t.activeCell;console.log(`[DEBUG] Updating cell toolbar command state, activeCell: ${n}`),r.forEach((t=>{e.commands.notifyCommandChanged(t.id)}))};t.currentChanged&&(console.log("[DEBUG] Connecting to notebookTracker.currentChanged signal"),t.currentChanged.connect(((e,t)=>{console.log("[DEBUG] Current notebook changed:",!!t),s()}))),t.activeCellChanged&&(console.log("[DEBUG] Connecting to notebookTracker.activeCellChanged signal"),t.activeCellChanged.connect(((e,t)=>{console.log("[DEBUG] Active cell changed:",!!t),s()}))),e.commands.commandExecuted.connect(((e,n)=>{if(r.some((e=>e.id===n.id))){console.log(`[DEBUG] Cell toolbar command executed: ${n.id}`);const e=t.activeCell;if(e)try{const t=e.model.sharedModel.getSource();console.log(`[DEBUG] Active cell content (${t.length} chars):`,t.substring(0,100)+(t.length>100?"...":"")),console.log(`[DEBUG] Cell type: ${e.model.type}`)}catch(e){console.error("[DEBUG] Error getting cell content:",e)}}})),console.log("[DEBUG] JupyterLab AI Assistant Cell Toolbar is activated!")}),Y={id:"jupyterlab-ai-assistant:plugin",description:"A JupyterLab extension for AI-assisted coding using Ollama",autoStart:!0,requires:[F.INotebookTracker],optional:[l.ICommandPalette,"launcher",T.ILayoutRestorer,L.IMainMenu,l.IThemeManager,R.ISettingRegistry],activate:async(e,t,n,o,c,i,d,m)=>{if(e.aiAssistantActivated)return void console.log("JupyterLab AI Assistant already activated, skipping...");e.aiAssistantActivated=!0,console.log("JupyterLab extension jupyterlab-ai-assistant is activated!"),console.debug("NotebookTracker initial state:",{currentWidget:t.currentWidget,hasSignals:!!t.activeCellChanged,widgetCount:t.size}),m&&m.load(Y.id).then((e=>{console.log("Settings loaded:",e.composite)})).catch((e=>{console.error("Failed to load settings",e)}));const{commands:u}=e;let p=!1;if(p)return void console.log("JupyterLab extension jupyterlab-ai-assistant is already activated.");p=!0;let h="",f=[];const y="ai-assistant:test-ollama",w="ai-assistant:open-chat";let x=null;const E=()=>{if(x){for(;x.items.length>0;)x.removeItemAt(0);f.forEach((e=>{const t=`ai-assistant:select-model-${e}`;u.hasCommand(t)||u.addCommand(t,{label:e,execute:()=>{h=e,console.log(`[DEBUG] Selected model for cell toolbar: ${h}`),u.notifyCommandChanged("ai-assistant:analyze-cell"),u.notifyCommandChanged("ai-assistant:optimize-cell"),u.notifyCommandChanged("ai-assistant:debug-cell"),E()},isToggled:()=>h===e}),x.addItem({command:t})})),f.length>0&&x.addItem({type:"separator"}),x.addItem({command:k})}};if(m)try{const e=(await m.load("jupyterlab-ai-assistant:plugin")).get("defaultModel").composite||"llama2";h=e}catch(e){console.warn("Failed to load settings:",e),h="llama2"}try{const e=await g();f=e.map((e=>e.name)),console.log("Available models:",f),f.length>0&&!f.includes(h)&&(h=f[0])}catch(e){console.error("Failed to fetch available models:",e)}u.addCommand(y,{label:"Show Available Ollama Models",execute:()=>{try{const t=b();return e.shell.add(t,"main"),t}catch(e){return console.error("Failed to create Ollama test widget:",e),null}}}),u.addCommand(w,{label:"Open AI Assistant Chat",icon:v.userIcon,execute:()=>{try{const t=`ai-assistant-chat-${Date.now()}`,n=(0,P.toArray)(e.shell.widgets("right")).find((e=>e.id===t));if(n)return e.shell.activateById(n.id),n;const o=new M({themeManager:d});return o.id=t,o.title.closable=!0,e.shell.add(o,"right",{rank:1e3}),e.shell.activateById(o.id),o}catch(e){return console.error("Failed to create chat widget:",e),null}}}),u.addCommand("ai-assistant:analyze-cell",{label:()=>`Explain Code with AI (${h})`,icon:v.searchIcon,execute:async()=>{try{if(console.log("[DEBUG] Executing ai-assistant:analyze-cell command"),null==t?void 0:t.activeCell){const e=t.activeCell;console.log("[DEBUG] Active cell found, type:",e.model.type);const n=document.createElement("div");n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.zIndex="1000",document.body.appendChild(n);const o=()=>{s.unmountComponentAtNode(n),document.body.removeChild(n)};s.render(a().createElement(q,{cell:e,onClose:o,selectedModel:h,initialAction:"explain"}),n)}else console.warn("[DEBUG] No active cell found for analysis"),(0,l.showDialog)({title:"No Active Cell",body:"Please select a cell to analyze",buttons:[l.Dialog.okButton()]})}catch(e){console.error("[DEBUG] Error analyzing cell:",e),(0,l.showDialog)({title:"Error",body:`An error occurred: ${e.message||"Unknown error"}`,buttons:[l.Dialog.okButton()]})}},isEnabled:()=>{const e=!(!(null==t?void 0:t.currentWidget)||!(null==t?void 0:t.activeCell));return console.log("[DEBUG] ai-assistant:analyze-cell enabled:",e),e}}),u.addCommand("ai-assistant:optimize-cell",{label:()=>`Optimize Code with AI (${h})`,icon:v.buildIcon,execute:async()=>{try{if(console.log("[DEBUG] Executing ai-assistant:optimize-cell command"),null==t?void 0:t.activeCell){const e=t.activeCell;console.log("[DEBUG] Active cell found for optimization, type:",e.model.type);const n=document.createElement("div");n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.zIndex="1000",document.body.appendChild(n);const o=()=>{s.unmountComponentAtNode(n),document.body.removeChild(n)};s.render(a().createElement(q,{cell:e,onClose:o,selectedModel:h,initialAction:"optimize"}),n)}else console.warn("[DEBUG] No active cell found for optimization"),(0,l.showDialog)({title:"No Active Cell",body:"Please select a cell to optimize",buttons:[l.Dialog.okButton()]})}catch(e){console.error("[DEBUG] Error optimizing cell:",e),(0,l.showDialog)({title:"Error",body:`An error occurred: ${e.message||"Unknown error"}`,buttons:[l.Dialog.okButton()]})}},isEnabled:()=>{const e=!(!(null==t?void 0:t.currentWidget)||!(null==t?void 0:t.activeCell));return console.log("[DEBUG] ai-assistant:optimize-cell enabled:",e),e}}),u.addCommand("ai-assistant:debug-cell",{label:()=>`Debug Code with AI (${h})`,icon:v.bugIcon,execute:async()=>{try{if(console.log("[DEBUG] Executing ai-assistant:debug-cell command"),null==t?void 0:t.activeCell){const e=t.activeCell;console.log("[DEBUG] Active cell found for debugging, type:",e.model.type);const n=document.createElement("div");n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.zIndex="1000",document.body.appendChild(n);const o=()=>{s.unmountComponentAtNode(n),document.body.removeChild(n)};s.render(a().createElement(q,{cell:e,onClose:o,selectedModel:h,initialAction:"debug"}),n)}else console.warn("[DEBUG] No active cell found for debugging"),(0,l.showDialog)({title:"No Active Cell",body:"Please select a cell to debug",buttons:[l.Dialog.okButton()]})}catch(e){console.error("[DEBUG] Error debugging cell:",e),(0,l.showDialog)({title:"Error",body:`An error occurred: ${e.message||"Unknown error"}`,buttons:[l.Dialog.okButton()]})}},isEnabled:()=>{const e=!(!(null==t?void 0:t.currentWidget)||!(null==t?void 0:t.activeCell));return console.log("[DEBUG] ai-assistant:debug-cell enabled:",e),e}}),u.addCommand("ai-assistant:chat-cell",{label:()=>`Chat about Code with AI (${h})`,icon:v.userIcon,execute:async()=>{try{if(console.log("[DEBUG] Executing ai-assistant:chat-cell command"),null==t?void 0:t.activeCell){const e=t.activeCell;console.log("[DEBUG] Active cell found for chat, type:",e.model.type);const n=document.createElement("div");n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.zIndex="1000",document.body.appendChild(n);const o=()=>{s.unmountComponentAtNode(n),document.body.removeChild(n)};s.render(a().createElement(q,{cell:e,onClose:o,selectedModel:h,initialAction:"chat"}),n)}else console.warn("[DEBUG] No active cell found for chat"),(0,l.showDialog)({title:"No Active Cell",body:"Please select a cell to chat about",buttons:[l.Dialog.okButton()]})}catch(e){console.error("[DEBUG] Error starting chat:",e),(0,l.showDialog)({title:"Error",body:`An error occurred: ${e.message||"Unknown error"}`,buttons:[l.Dialog.okButton()]})}},isEnabled:()=>{const e=!(!(null==t?void 0:t.currentWidget)||!(null==t?void 0:t.activeCell));return console.log("[DEBUG] ai-assistant:chat-cell enabled:",e),e}});const k="ai-assistant:refresh-models";if(u.addCommand(k,{label:"Refresh Available Models",execute:async()=>{try{console.log("[DEBUG] Refreshing available models...");const e=await g();f=e.map((e=>e.name)),console.log("[DEBUG] Refreshed models list:",f),f.length>0&&!f.includes(h)&&(h=f[0],console.log(`[DEBUG] Current model not available, switching to ${h}`)),u.notifyCommandChanged("ai-assistant:analyze-cell"),u.notifyCommandChanged("ai-assistant:optimize-cell"),u.notifyCommandChanged("ai-assistant:debug-cell"),"function"==typeof E&&E(),(0,l.showDialog)({title:"Models Refreshed",body:`Found ${f.length} available models.`,buttons:[l.Dialog.okButton()]})}catch(e){console.error("[DEBUG] Error refreshing models:",e),(0,l.showDialog)({title:"Error Refreshing Models",body:`Failed to refresh models: ${e.message||"Unknown error"}`,buttons:[l.Dialog.okButton()]})}}}),n&&"function"==typeof n.addItem)try{n.addItem({command:y,category:"AI Assistant"}),n.addItem({command:w,category:"AI Assistant"}),n.addItem({command:"ai-assistant:analyze-cell",category:"AI Assistant"}),n.addItem({command:"ai-assistant:optimize-cell",category:"AI Assistant"}),n.addItem({command:"ai-assistant:debug-cell",category:"AI Assistant"}),n.addItem({command:"ai-assistant:chat-cell",category:"AI Assistant"})}catch(e){console.error("Failed to add commands to palette:",e)}if(i&&"function"==typeof i.addMenu)try{const e=new r.Menu({commands:u});e.title.label="AI Assistant",e.addItem({command:w}),e.addItem({command:y}),x=new r.Menu({commands:u}),x.title.label="Select Default Model",E(),e.addItem({type:"submenu",submenu:x}),e.addItem({type:"separator"});const t=new r.Menu({commands:u});t.title.label="Cell Actions",t.addItem({command:"ai-assistant:analyze-cell"}),t.addItem({command:"ai-assistant:optimize-cell"}),t.addItem({command:"ai-assistant:debug-cell"}),t.addItem({command:"ai-assistant:chat-cell"}),e.addItem({type:"submenu",submenu:t}),i.addMenu(e)}catch(e){console.error("Failed to create AI menu:",e)}if(o&&"function"==typeof o.add)try{o.add({command:w,category:"AI Assistant",rank:1}),o.add({command:y,category:"AI Assistant",rank:2})}catch(e){console.error("Failed to add commands to launcher:",e)}try{await W(e,m)}catch(e){console.error("Failed to activate cell toolbar plugin:",e)}}},_=Y},7115:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23dee2e6%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e"},7154:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e"},7210:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23052c65%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27M2 5L8 11L14 5%27/%3e%3c/svg%3e"},7249:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z%27/%3e%3c/svg%3e"},7326:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27none%27 stroke=%27%23212529%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpath d=%27M2 5L8 11L14 5%27/%3e%3c/svg%3e"},8487:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e"},8734:e=>{e.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%28255, 255, 255, 0.25%29%27/%3e%3c/svg%3e"}}]);