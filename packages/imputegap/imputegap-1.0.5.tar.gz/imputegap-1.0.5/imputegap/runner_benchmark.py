import numpy as np

from imputegap.recovery.benchmark import Benchmark

# define analysis global variables
reconstruction = False
save_dir = "./analysis"
nbr_run = 1

# define the datasets to evaluate
datasets_full = ["eeg-alcohol", "eeg-reading", "fmri-objectviewing", "fmri-stoptask", "chlorine", "drift"]
datasets = ["chlorine", "eeg-reading"]

# define the optimizer to fine-tine the algorithms
optimiser_bayesian = {"optimizer": "bayesian", "options": {"n_calls": 2, "n_random_starts": 50, "acq_func": "gp_hedge", "metrics": "RMSE"}}
optimiser_greedy = {"optimizer": "greedy", "options": {"n_calls": 250, "metrics": "RMSE"}}
optimiser_pso = {"optimizer": "pso", "options": {"n_particles": 50, "iterations": 10, "metrics": "RMSE"}}
optimiser_sh = {"optimizer": "sh", "options": {"num_configs": 10, "num_iterations": 5, "metrics": "RMSE"}}
optimiser_ray = {"optimizer": "ray_tune", "options": {"n_calls": 1, "max_concurrent_trials": 1}}
optimizers = [optimiser_ray]

# define the algorithms for the imputation
algorithms = ["MeanImpute", "CDRec", "STMVL", "IIM", "MRNN"]

# define the missing pattern to contaminate the time series
patterns_full = ["mcar", "mp", "blackout", "disjoint", "overlap", "gaussian"]
patterns = ["mcar"]

# define missing values percentages to see the evolution of the imputation
range = [0.05, 0.1, 0.2, 0.4, 0.6, 0.8]


if not reconstruction:
    # launch the analysis
    list_results, sum_scores = Benchmark().eval(algorithms=algorithms, datasets=datasets, patterns=patterns, x_axis=range, optimizers=optimizers, save_dir=save_dir, runs=nbr_run)
else:
    test_plots = {'eegreading': {'mp': {'mean': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.9585345039764159, 'MAE': 0.71318962961796, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0001308917999267578, 'optimization': 0.0, 'imputation': 0.0005505084991455078, 'log_imputation': -3.25923597169041}}, '0.1': {'scores': {'RMSE': 1.158802114694506, 'MAE': 0.9654264194724749, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.00028133392333984375, 'optimization': 0.0, 'imputation': 0.0002911090850830078, 'log_imputation': -3.5359442406627037}}, '0.2': {'scores': {'RMSE': 0.9366041090001302, 'MAE': 0.713304743455646, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.00025653839111328125, 'optimization': 0.0, 'imputation': 0.0002605915069580078, 'log_imputation': -3.5840397426578834}}, '0.4': {'scores': {'RMSE': 1.0599636170074507, 'MAE': 0.8381968262587581, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0006632804870605469, 'optimization': 0.0, 'imputation': 0.00026726722717285156, 'log_imputation': -3.573054292012613}}, '0.6': {'scores': {'RMSE': 1.0562417941470534, 'MAE': 0.8508551190781458, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0013227462768554688, 'optimization': 0.0, 'imputation': 0.0002796649932861328, 'log_imputation': -3.553361892492057}}, '0.7': {'scores': {'RMSE': 1.040204405772873, 'MAE': 0.8335213108852025, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0017957687377929688, 'optimization': 0.0, 'imputation': 0.00025272369384765625, 'log_imputation': -3.597354039342816}}}}, 'cdrec': {'ray_tune': {'0.05': {'scores': {'RMSE': 1.1697500835978993, 'MAE': 0.9591122423282666, 'MI': 0.874795673555792, 'CORRELATION': -0.6435768999074719}, 'times': {'contamination': 0.00013375282287597656, 'optimization': 7.705925226211548, 'imputation': 0.03410458564758301, 'log_imputation': -1.4671872225457172}}, '0.1': {'scores': {'RMSE': 1.160748195036071, 'MAE': 0.9801100319738002, 'MI': 0.24843228556023436, 'CORRELATION': -0.1457168801420723}, 'times': {'contamination': 0.0010766983032226562, 'optimization': 7.705925226211548, 'imputation': 0.0187838077545166, 'log_imputation': -1.7262163652567906}}, '0.2': {'scores': {'RMSE': 0.9258702230012604, 'MAE': 0.7412912028091162, 'MI': 0.09990051537425793, 'CORRELATION': 0.018312853013798043}, 'times': {'contamination': 0.0012714862823486328, 'optimization': 7.705925226211548, 'imputation': 0.06531453132629395, 'log_imputation': -1.184990185145398}}, '0.4': {'scores': {'RMSE': 1.0158290954098952, 'MAE': 0.7699069240021237, 'MI': 0.043509996942918995, 'CORRELATION': 0.026854101443570477}, 'times': {'contamination': 0.002095460891723633, 'optimization': 7.705925226211548, 'imputation': 0.06960487365722656, 'log_imputation': -1.1573603504995333}}, '0.6': {'scores': {'RMSE': 1.074841191421588, 'MAE': 0.8305870491121395, 'MI': 0.04052775735888883, 'CORRELATION': 0.02240964134518767}, 'times': {'contamination': 0.003614664077758789, 'optimization': 7.705925226211548, 'imputation': 0.11719846725463867, 'log_imputation': -0.9310780680722405}}, '0.7': {'scores': {'RMSE': 1.028461165376999, 'MAE': 0.8037932945848046, 'MI': 0.04862782947355959, 'CORRELATION': 0.28310309461657}, 'times': {'contamination': 0.004042148590087891, 'optimization': 7.705925226211548, 'imputation': 0.14756202697753906, 'log_imputation': -0.8310253877423743}}}}, 'stmvl': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.7277001471585042, 'MAE': 0.6187129093081218, 'MI': 0.849293361425945, 'CORRELATION': 0.6050898026864381}, 'times': {'contamination': 0.0003566741943359375, 'optimization': 401.3516755104065, 'imputation': 13.703130722045898, 'log_imputation': 1.1368198007314763}}, '0.1': {'scores': {'RMSE': 0.9169700690065775, 'MAE': 0.7874056676843385, 'MI': 0.3666479681879978, 'CORRELATION': 0.5010483466574436}, 'times': {'contamination': 0.00020051002502441406, 'optimization': 401.3516755104065, 'imputation': 13.661174535751343, 'log_imputation': 1.1354880399360694}}, '0.2': {'scores': {'RMSE': 0.7183875117312635, 'MAE': 0.5896797263562054, 'MI': 0.24774404354441104, 'CORRELATION': 0.46263398990236104}, 'times': {'contamination': 0.0002193450927734375, 'optimization': 401.3516755104065, 'imputation': 13.761161088943481, 'log_imputation': 1.1386550787575944}}, '0.4': {'scores': {'RMSE': 0.8742119003541577, 'MAE': 0.6297161236774441, 'MI': 0.12171661757737935, 'CORRELATION': 0.2830622046394087}, 'times': {'contamination': 0.0006110668182373047, 'optimization': 401.3516755104065, 'imputation': 14.14597225189209, 'log_imputation': 1.1506328018545884}}, '0.6': {'scores': {'RMSE': 20.12875114987835, 'MAE': 3.972851513364007, 'MI': 0.005760162876990282, 'CORRELATION': -0.0020763310368411936}, 'times': {'contamination': 0.001154184341430664, 'optimization': 401.3516755104065, 'imputation': 8.714907884597778, 'log_imputation': 0.9402628010361087}}, '0.7': {'scores': {'RMSE': 0.9089996638242581, 'MAE': 0.7155219794334919, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.001634359359741211, 'optimization': 401.3516755104065, 'imputation': 8.389863967895508, 'log_imputation': 0.9237549192945785}}}}, 'iim': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.9917499844047692, 'MAE': 0.6835294570359077, 'MI': 1.0383833294554503, 'CORRELATION': 0.39342144548050073}, 'times': {'contamination': 0.00010991096496582031, 'optimization': 87.12388730049133, 'imputation': 0.1563720703125, 'log_imputation': -0.8058408138870692}}, '0.1': {'scores': {'RMSE': 0.5640999644452854, 'MAE': 0.436875650594336, 'MI': 0.9382015646212765, 'CORRELATION': 0.8446597946056835}, 'times': {'contamination': 0.000209808349609375, 'optimization': 87.12388730049133, 'imputation': 1.0088622570037842, 'log_imputation': 0.003831874753497683}}, '0.2': {'scores': {'RMSE': 0.5524062619653164, 'MAE': 0.4527739222276905, 'MI': 0.4682825796414235, 'CORRELATION': 0.734130718955202}, 'times': {'contamination': 0.00021195411682128906, 'optimization': 87.12388730049133, 'imputation': 6.273438930511475, 'log_imputation': 0.7975056746615543}}, '0.4': {'scores': {'RMSE': 0.6703666990440234, 'MAE': 0.5167364139824571, 'MI': 0.25478017143468495, 'CORRELATION': 0.6160285049199379}, 'times': {'contamination': 0.0006020069122314453, 'optimization': 87.12388730049133, 'imputation': 48.24830389022827, 'log_imputation': 1.683482050859879}}, '0.6': {'scores': {'RMSE': 0.846371619650148, 'MAE': 0.6521374554849746, 'MI': 0.10898611984678795, 'CORRELATION': 0.37877848480193976}, 'times': {'contamination': 0.0012598037719726562, 'optimization': 87.12388730049133, 'imputation': 148.6065971851349, 'log_imputation': 2.1720380897576836}}, '0.7': {'scores': {'RMSE': 0.939708165479016, 'MAE': 0.7342180002582285, 'MI': 0.0747388622783703, 'CORRELATION': 0.3115372974410071}, 'times': {'contamination': 0.0016543865203857422, 'optimization': 87.12388730049133, 'imputation': 240.74761581420898, 'log_imputation': 2.3815619948874964}}}}, 'mrnn': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.5647614331747706, 'MAE': 0.4956801381604213, 'MI': 0.602588078427742, 'CORRELATION': 0.7892828777307545}, 'times': {'contamination': 0.00017881393432617188, 'optimization': 23.75439763069153, 'imputation': 9.659311532974243, 'log_imputation': 0.9849461731975306}}, '0.1': {'scores': {'RMSE': 1.4942930218243802, 'MAE': 1.2039603558089516, 'MI': 0.47511351289726134, 'CORRELATION': -0.24282448220213368}, 'times': {'contamination': 0.00033783912658691406, 'optimization': 23.75439763069153, 'imputation': 9.660546064376831, 'log_imputation': 0.985001675695301}}, '0.2': {'scores': {'RMSE': 1.493030946284299, 'MAE': 1.2759205639542883, 'MI': 0.14247255829853323, 'CORRELATION': 0.17585501858419272}, 'times': {'contamination': 0.0004456043243408203, 'optimization': 23.75439763069153, 'imputation': 9.614870071411133, 'log_imputation': 0.982943419864104}}, '0.4': {'scores': {'RMSE': 1.6610979347034713, 'MAE': 1.32902912214158, 'MI': 0.07259583818478979, 'CORRELATION': -0.04241780698399349}, 'times': {'contamination': 0.0007512569427490234, 'optimization': 23.75439763069153, 'imputation': 9.778327465057373, 'log_imputation': 0.9902645771992502}}, '0.6': {'scores': {'RMSE': 1.6248154262874046, 'MAE': 1.3587893211292972, 'MI': 0.04243232622955761, 'CORRELATION': -0.05349772421574814}, 'times': {'contamination': 0.0013408660888671875, 'optimization': 23.75439763069153, 'imputation': 9.961318492889404, 'log_imputation': 0.9983168260028805}}, '0.7': {'scores': {'RMSE': 1.3781088381679387, 'MAE': 1.102321907630172, 'MI': 0.013439658692967605, 'CORRELATION': -0.01874660352385742}, 'times': {'contamination': 0.0019338130950927734, 'optimization': 23.75439763069153, 'imputation': 9.934946298599243, 'log_imputation': 0.9971655239586622}}}}, 'knn': {'ray_tune': {'0.05': {'scores': {'RMSE': 1.0891820888848962, 'MAE': 0.8741423177191895, 'MI': 1.0726621001615337, 'CORRELATION': 0.23766946742758965}, 'times': {'contamination': 0.0002646446228027344, 'optimization': 5.975560188293457, 'imputation': 0.004753589630126953, 'log_imputation': -2.3229783129452315}}, '0.1': {'scores': {'RMSE': 0.6835893631062424, 'MAE': 0.5234507579018903, 'MI': 0.7407074666713884, 'CORRELATION': 0.7645134370284421}, 'times': {'contamination': 0.00014519691467285156, 'optimization': 5.975560188293457, 'imputation': 0.006691694259643555, 'log_imputation': -2.174463909966519}}, '0.2': {'scores': {'RMSE': 0.5992380715293445, 'MAE': 0.4859085244932665, 'MI': 0.4086948138880703, 'CORRELATION': 0.6965923314128772}, 'times': {'contamination': 0.0002143383026123047, 'optimization': 5.975560188293457, 'imputation': 0.013432025909423828, 'log_imputation': -1.8718584791459945}}, '0.4': {'scores': {'RMSE': 0.6868836297408376, 'MAE': 0.5093608359137556, 'MI': 0.2868485602164113, 'CORRELATION': 0.6240763887663399}, 'times': {'contamination': 0.0005633831024169922, 'optimization': 5.975560188293457, 'imputation': 0.039768218994140625, 'log_imputation': -1.4004638583058664}}, '0.6': {'scores': {'RMSE': 0.7785967363211405, 'MAE': 0.6158636946887723, 'MI': 0.19729389232186453, 'CORRELATION': 0.5576154866890136}, 'times': {'contamination': 0.001161813735961914, 'optimization': 5.975560188293457, 'imputation': 0.0798337459564209, 'log_imputation': -1.0978134922993485}}, '0.7': {'scores': {'RMSE': 0.867427846592856, 'MAE': 0.6717590115075687, 'MI': 0.1554022092659651, 'CORRELATION': 0.5020021909165999}, 'times': {'contamination': 0.0016968250274658203, 'optimization': 5.975560188293457, 'imputation': 0.1084587574005127, 'log_imputation': -0.9647353755339024}}}}, 'interpolation': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.652962872644497, 'MAE': 0.5073890992493721, 'MI': 0.8457271995908064, 'CORRELATION': 0.8055318132299937}, 'times': {'contamination': 8.559226989746094e-05, 'optimization': 5.141337633132935, 'imputation': 0.0051326751708984375, 'log_imputation': -2.289656219851888}}, '0.1': {'scores': {'RMSE': 1.0026771443357805, 'MAE': 0.8585128588487265, 'MI': 0.7175551546841298, 'CORRELATION': 0.2953791171260645}, 'times': {'contamination': 0.00017213821411132812, 'optimization': 5.141337633132935, 'imputation': 0.005180835723876953, 'log_imputation': -2.2856001782870616}}, '0.2': {'scores': {'RMSE': 0.8233555140431951, 'MAE': 0.6703672843514312, 'MI': 0.13551988197466275, 'CORRELATION': 0.015002239969896275}, 'times': {'contamination': 0.00030040740966796875, 'optimization': 5.141337633132935, 'imputation': 0.005160808563232422, 'log_imputation': -2.287282250496757}}, '0.4': {'scores': {'RMSE': 0.9363419996773169, 'MAE': 0.7074318048367104, 'MI': 0.08116508553549509, 'CORRELATION': -0.08485974486524711}, 'times': {'contamination': 0.0009136199951171875, 'optimization': 5.141337633132935, 'imputation': 0.004884481430053711, 'log_imputation': -2.3111815371695186}}, '0.6': {'scores': {'RMSE': 0.8950363345080617, 'MAE': 0.6884297374643212, 'MI': 0.08082734535733935, 'CORRELATION': 0.057185769477410595}, 'times': {'contamination': 0.0019223690032958984, 'optimization': 5.141337633132935, 'imputation': 0.0045621395111083984, 'log_imputation': -2.340831438047068}}, '0.7': {'scores': {'RMSE': 0.9120956983333071, 'MAE': 0.7040561838341391, 'MI': 0.09963198754695206, 'CORRELATION': 0.2045739832314467}, 'times': {'contamination': 0.002409696578979492, 'optimization': 5.141337633132935, 'imputation': 0.003817319869995117, 'log_imputation': -2.4182414470843363}}}}, 'iter_svd': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.9678965095170196, 'MAE': 0.7832040083975756, 'MI': 0.6701866174566358, 'CORRELATION': 0.2906340418705714}, 'times': {'contamination': 0.00011491775512695312, 'optimization': 6.1171875, 'imputation': 0.16927814483642578, 'log_imputation': -0.7713991091659277}}, '0.1': {'scores': {'RMSE': 1.206641825424519, 'MAE': 0.9957142418212448, 'MI': 0.25957158894434323, 'CORRELATION': 0.3379497812910825}, 'times': {'contamination': 0.0002319812774658203, 'optimization': 6.1171875, 'imputation': 0.025690555572509766, 'log_imputation': -1.5902265037731111}}, '0.2': {'scores': {'RMSE': 2.744919655781878, 'MAE': 1.0715001061469325, 'MI': 0.09892723156881575, 'CORRELATION': 0.19989476403758802}, 'times': {'contamination': 0.00040030479431152344, 'optimization': 6.1171875, 'imputation': 0.20974421501159668, 'log_imputation': -0.6783100086789446}}, '0.4': {'scores': {'RMSE': 2.325212272472014, 'MAE': 1.0008159007710338, 'MI': 0.039044612581955955, 'CORRELATION': 0.18525435207618218}, 'times': {'contamination': 0.001310586929321289, 'optimization': 6.1171875, 'imputation': 0.12171530723571777, 'log_imputation': -0.9146548003240639}}, '0.6': {'scores': {'RMSE': 1.5405789466020037, 'MAE': 0.8730700982169517, 'MI': 0.02272278491667953, 'CORRELATION': 0.13522799408559083}, 'times': {'contamination': 0.0025451183319091797, 'optimization': 6.1171875, 'imputation': 0.11439800262451172, 'log_imputation': -0.9415815582066798}}, '0.7': {'scores': {'RMSE': 1.841900634203058, 'MAE': 1.0796597078220702, 'MI': 0.02557622581974515, 'CORRELATION': 0.16934790654103044}, 'times': {'contamination': 0.0034818649291992188, 'optimization': 6.1171875, 'imputation': 0.13515305519104004, 'log_imputation': -0.8691741324468487}}}}, 'grouse': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.7612079759584908, 'MAE': 0.6174023101930106, 'MI': 0.9720614292082763, 'CORRELATION': 0.5230250494004521}, 'times': {'contamination': 0.0002720355987548828, 'optimization': 5.722500801086426, 'imputation': 0.04196357727050781, 'log_imputation': -1.3771274965838058}}, '0.1': {'scores': {'RMSE': 0.7161433320631904, 'MAE': 0.6159111612486882, 'MI': 0.6397891170137576, 'CORRELATION': 0.7446871990437298}, 'times': {'contamination': 0.00019860267639160156, 'optimization': 5.722500801086426, 'imputation': 0.03328585624694824, 'log_imputation': -1.4777402667567205}}, '0.2': {'scores': {'RMSE': 0.6898292077596729, 'MAE': 0.5578803290483622, 'MI': 0.2578762805889524, 'CORRELATION': 0.5664833343935345}, 'times': {'contamination': 0.00022554397583007812, 'optimization': 5.722500801086426, 'imputation': 0.0313875675201416, 'log_imputation': -1.5032423400347081}}, '0.4': {'scores': {'RMSE': 2.1034364753786474, 'MAE': 1.3168644171392099, 'MI': 0.08186758416407369, 'CORRELATION': -0.11621144175246101}, 'times': {'contamination': 0.0006256103515625, 'optimization': 5.722500801086426, 'imputation': 0.030426025390625, 'log_imputation': -1.5167547766480622}}, '0.6': {'scores': {'RMSE': 2.3833534619751133, 'MAE': 1.5821816756647928, 'MI': 0.054626775241568545, 'CORRELATION': 0.015738449816948538}, 'times': {'contamination': 0.0012514591217041016, 'optimization': 5.722500801086426, 'imputation': 0.028280258178710938, 'log_imputation': -1.5485166300562665}}, '0.7': {'scores': {'RMSE': 7.180320793620952, 'MAE': 4.468603088484079, 'MI': 0.04077789644280901, 'CORRELATION': 0.06730823975418755}, 'times': {'contamination': 0.0017271041870117188, 'optimization': 5.722500801086426, 'imputation': 0.02826690673828125, 'log_imputation': -1.5487217139723333}}}}, 'dynammo': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.7151415190942114, 'MAE': 0.4970782244594254, 'MI': 1.000759224589441, 'CORRELATION': 0.6184557637516255}, 'times': {'contamination': 9.775161743164062e-05, 'optimization': 7.155381441116333, 'imputation': 0.37074732780456543, 'log_imputation': -0.4309219705056871}}, '0.1': {'scores': {'RMSE': 0.596699604024305, 'MAE': 0.47938493632400186, 'MI': 0.775707195092484, 'CORRELATION': 0.8215645013506228}, 'times': {'contamination': 0.00023412704467773438, 'optimization': 7.155381441116333, 'imputation': 0.28595781326293945, 'log_imputation': -0.5436980326699488}}, '0.2': {'scores': {'RMSE': 0.5449085417487771, 'MAE': 0.43145124521055284, 'MI': 0.4427805840998743, 'CORRELATION': 0.7430502246596334}, 'times': {'contamination': 0.0002410411834716797, 'optimization': 7.155381441116333, 'imputation': 0.26209354400634766, 'log_imputation': -0.5815436766381012}}, '0.4': {'scores': {'RMSE': 0.6779705022363695, 'MAE': 0.5174517186640625, 'MI': 0.2637670732890106, 'CORRELATION': 0.5964668677202103}, 'times': {'contamination': 0.0006296634674072266, 'optimization': 7.155381441116333, 'imputation': 0.25553178787231445, 'log_imputation': -0.5925550664145126}}, '0.6': {'scores': {'RMSE': 0.7411789471267709, 'MAE': 0.5759604675111509, 'MI': 0.1463028452878696, 'CORRELATION': 0.4736194559909744}, 'times': {'contamination': 0.0011439323425292969, 'optimization': 7.155381441116333, 'imputation': 0.24941730499267578, 'log_imputation': -0.6030734177295504}}, '0.7': {'scores': {'RMSE': 0.793531390474089, 'MAE': 0.6252896196336124, 'MI': 0.12414974056261635, 'CORRELATION': 0.42841122847547475}, 'times': {'contamination': 0.001678466796875, 'optimization': 7.155381441116333, 'imputation': 0.2493579387664795, 'log_imputation': -0.6031768006656235}}}}, 'rosl': {'ray_tune': {'0.05': {'scores': {'RMSE': 1.0499537991118213, 'MAE': 0.8595954149037424, 'MI': 1.0993381984756705, 'CORRELATION': 0.6146787951828591}, 'times': {'contamination': 8.320808410644531e-05, 'optimization': 8.010011911392212, 'imputation': 0.6821448802947998, 'log_imputation': -0.16612337603230268}}, '0.1': {'scores': {'RMSE': 0.8867665835064245, 'MAE': 0.7010242781890926, 'MI': 0.5907204950909528, 'CORRELATION': 0.5334857453342065}, 'times': {'contamination': 0.0007736682891845703, 'optimization': 8.010011911392212, 'imputation': 0.8041999340057373, 'log_imputation': -0.09463596687218417}}, '0.2': {'scores': {'RMSE': 0.6880103343296596, 'MAE': 0.5541578539667452, 'MI': 0.24039836995684236, 'CORRELATION': 0.5427450775696447}, 'times': {'contamination': 0.00044655799865722656, 'optimization': 8.010011911392212, 'imputation': 0.9774386882781982, 'log_imputation': -0.00991047503446148}}, '0.4': {'scores': {'RMSE': 0.8651150824896394, 'MAE': 0.6877854522472314, 'MI': 0.1690613590574013, 'CORRELATION': 0.5410193369282997}, 'times': {'contamination': 0.001178741455078125, 'optimization': 8.010011911392212, 'imputation': 1.1973018646240234, 'log_imputation': 0.07820365885488725}}, '0.6': {'scores': {'RMSE': 0.9166362987192727, 'MAE': 0.721692537549043, 'MI': 0.02863175412827265, 'CORRELATION': 0.17277873288296303}, 'times': {'contamination': 0.002458333969116211, 'optimization': 8.010011911392212, 'imputation': 0.9381327629089355, 'log_imputation': -0.027735696675609416}}, '0.7': {'scores': {'RMSE': 0.906714486614649, 'MAE': 0.7137640362967337, 'MI': 0.018810170348030363, 'CORRELATION': 0.13788600397722242}, 'times': {'contamination': 0.003499269485473633, 'optimization': 8.010011911392212, 'imputation': 0.9922640323638916, 'log_imputation': -0.0033727506872492066}}}}, 'soft_imp': {'ray_tune': {'0.05': {'scores': {'RMSE': 2.0339216249617187, 'MAE': 1.2856996084517671, 'MI': 0.5586713713860293, 'CORRELATION': 0.19929770644664235}, 'times': {'contamination': 0.0002562999725341797, 'optimization': 6.165367603302002, 'imputation': 0.22596025466918945, 'log_imputation': -0.6459679444625233}}, '0.1': {'scores': {'RMSE': 2.996560504376057, 'MAE': 1.4890970543941768, 'MI': 0.10872128825197942, 'CORRELATION': -0.016649529237395322}, 'times': {'contamination': 0.0008714199066162109, 'optimization': 6.165367603302002, 'imputation': 0.24814844131469727, 'log_imputation': -0.6052884483753903}}, '0.2': {'scores': {'RMSE': 1.674129766854418, 'MAE': 0.8151640130294245, 'MI': 0.07665032967200101, 'CORRELATION': 0.12879732925631815}, 'times': {'contamination': 0.0010998249053955078, 'optimization': 6.165367603302002, 'imputation': 0.31171655654907227, 'log_imputation': -0.5062401299434305}}, '0.4': {'scores': {'RMSE': 1.4601220841860667, 'MAE': 0.8047931166368179, 'MI': 0.03296470473019845, 'CORRELATION': 0.13220172740281755}, 'times': {'contamination': 0.001886606216430664, 'optimization': 6.165367603302002, 'imputation': 0.44722557067871094, 'log_imputation': -0.34947337308411147}}, '0.6': {'scores': {'RMSE': 1.1510735383091752, 'MAE': 0.8067332887552809, 'MI': 0.025369317779971253, 'CORRELATION': 0.11787398625935817}, 'times': {'contamination': 0.0030333995819091797, 'optimization': 6.165367603302002, 'imputation': 0.44750356674194336, 'log_imputation': -0.3492034988728261}}, '0.7': {'scores': {'RMSE': 1.119056736039775, 'MAE': 0.8055779569701397, 'MI': 0.011612902407302311, 'CORRELATION': 0.11214948799086549}, 'times': {'contamination': 0.003826141357421875, 'optimization': 6.165367603302002, 'imputation': 0.44806480407714844, 'log_imputation': -0.34865916899792637}}}}, 'spirit': {'ray_tune': {'0.05': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0008153915405273438, 'optimization': 14.221216917037964, 'imputation': 0.02103590965270996, 'log_imputation': -1.6770387031092828}}, '0.1': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.00013113021850585938, 'optimization': 14.221216917037964, 'imputation': 0.020754098892211914, 'log_imputation': -1.6828961182062343}}, '0.2': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.00020623207092285156, 'optimization': 14.221216917037964, 'imputation': 0.020871877670288086, 'log_imputation': -1.6804384792927793}}, '0.4': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.000583648681640625, 'optimization': 14.221216917037964, 'imputation': 0.020839691162109375, 'log_imputation': -1.681108721437079}}, '0.6': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0011415481567382812, 'optimization': 14.221216917037964, 'imputation': 0.022094011306762695, 'log_imputation': -1.655725428074281}}, '0.7': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0016748905181884766, 'optimization': 14.221216917037964, 'imputation': 0.020914793014526367, 'log_imputation': -1.6795464291036162}}}}, 'svt': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.7117792258361312, 'MAE': 0.5168498358882081, 'MI': 0.9483793484273644, 'CORRELATION': 0.6542386230995083}, 'times': {'contamination': 9.989738464355469e-05, 'optimization': 45.67361259460449, 'imputation': 72.4662275314331, 'log_imputation': 1.8601356532745885}}, '0.1': {'scores': {'RMSE': 0.6394665297027734, 'MAE': 0.5211957976023045, 'MI': 0.8056798218248341, 'CORRELATION': 0.8508068326214364}, 'times': {'contamination': 0.0003097057342529297, 'optimization': 45.67361259460449, 'imputation': 75.2989776134491, 'log_imputation': 1.8767890795227222}}, '0.2': {'scores': {'RMSE': 0.5458488691493897, 'MAE': 0.4403496209659646, 'MI': 0.47611060408121514, 'CORRELATION': 0.7634239025059351}, 'times': {'contamination': 0.00045990943908691406, 'optimization': 45.67361259460449, 'imputation': 30.695201635360718, 'log_imputation': 1.4870704905860637}}, '0.4': {'scores': {'RMSE': 0.663135828087241, 'MAE': 0.4976907262970949, 'MI': 0.3313924262852707, 'CORRELATION': 0.6726174187230454}, 'times': {'contamination': 0.0017871856689453125, 'optimization': 45.67361259460449, 'imputation': 16.311678886413574, 'log_imputation': 1.2124986632831212}}, '0.6': {'scores': {'RMSE': 0.7020778058013225, 'MAE': 0.539085026607538, 'MI': 0.20478746906130402, 'CORRELATION': 0.5760668454355408}, 'times': {'contamination': 0.002444744110107422, 'optimization': 45.67361259460449, 'imputation': 93.80211400985718, 'log_imputation': 1.972212626145269}}, '0.7': {'scores': {'RMSE': 0.7658534267181207, 'MAE': 0.6009953789367053, 'MI': 0.17185882455524978, 'CORRELATION': 0.5331757977769946}, 'times': {'contamination': 0.0033347606658935547, 'optimization': 45.67361259460449, 'imputation': 72.77504920959473, 'log_imputation': 1.861982507775544}}}}, 'tkcm': {'ray_tune': {'0.05': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0007822513580322266, 'optimization': 5.649405241012573, 'imputation': 0.0011343955993652344, 'log_imputation': -2.9452354669063388}}, '0.1': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0006322860717773438, 'optimization': 5.649405241012573, 'imputation': 0.0011126995086669922, 'log_imputation': -2.9536221037224304}}, '0.2': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0009708404541015625, 'optimization': 5.649405241012573, 'imputation': 0.0010807514190673828, 'log_imputation': -2.9662741855488983}}, '0.4': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0028562545776367188, 'optimization': 5.649405241012573, 'imputation': 0.0011017322540283203, 'log_imputation': -2.957923936088881}}, '0.6': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.0057315826416015625, 'optimization': 5.649405241012573, 'imputation': 0.0011334419250488281, 'log_imputation': -2.945600727215425}}, '0.7': {'scores': {'RMSE': 100.0, 'MAE': 100.0, 'MI': 0.0, 'CORRELATION': 0.0}, 'times': {'contamination': 0.006317853927612305, 'optimization': 5.649405241012573, 'imputation': 0.0009458065032958984, 'log_imputation': -3.0241977041334356}}}}, 'brits': {'ray_tune': {'0.05': {'scores': {'RMSE': 1.3419411368774041, 'MAE': 1.1638434066271077, 'MI': 0.8951096093875868, 'CORRELATION': -0.5585099483296528}, 'times': {'contamination': 0.0003306865692138672, 'optimization': 228.5102288722992, 'imputation': 95.61461043357849, 'log_imputation': 1.980524259910658}}, '0.1': {'scores': {'RMSE': 1.2073040959274337, 'MAE': 0.9690312583388463, 'MI': 0.32167770615560765, 'CORRELATION': 0.10410551896912013}, 'times': {'contamination': 0.0002052783966064453, 'optimization': 228.5102288722992, 'imputation': 98.19476699829102, 'log_imputation': 1.992088343954746}}, '0.2': {'scores': {'RMSE': 1.0096095214334058, 'MAE': 0.8017626333243341, 'MI': 0.1545999150691882, 'CORRELATION': 0.04321071858521189}, 'times': {'contamination': 0.00027251243591308594, 'optimization': 228.5102288722992, 'imputation': 91.76230263710022, 'log_imputation': 1.9626643029973887}}, '0.4': {'scores': {'RMSE': 1.1021171834537435, 'MAE': 0.8109044008529219, 'MI': 0.06990935579232271, 'CORRELATION': 0.027418538197488553}, 'times': {'contamination': 0.0007600784301757812, 'optimization': 228.5102288722992, 'imputation': 92.40596151351929, 'log_imputation': 1.9656999903641312}}, '0.6': {'scores': {'RMSE': 0.9644643680536452, 'MAE': 0.7465535671618042, 'MI': 0.034792659544221505, 'CORRELATION': 0.17675436980090672}, 'times': {'contamination': 0.0012924671173095703, 'optimization': 228.5102288722992, 'imputation': 92.13396763801575, 'log_imputation': 1.9644197739326628}}, '0.7': {'scores': {'RMSE': 0.9815275917177589, 'MAE': 0.751919619563092, 'MI': 0.017952595001480262, 'CORRELATION': -0.05597093175861781}, 'times': {'contamination': 0.0018129348754882812, 'optimization': 228.5102288722992, 'imputation': 96.6255190372467, 'log_imputation': 1.9850918398051054}}}}, 'deep_mvi': {'ray_tune': {'0.05': {'scores': {'RMSE': 1.034412355455737, 'MAE': 0.8490322354281984, 'MI': 0.7750911481750873, 'CORRELATION': -0.0026999728861952163}, 'times': {'contamination': 0.00013065338134765625, 'optimization': 2490.3838233947754, 'imputation': 172.29269313812256, 'log_imputation': 2.2362668595891644}}, '0.1': {'scores': {'RMSE': 1.0247023047728139, 'MAE': 0.8590129463082453, 'MI': 0.26134381836602716, 'CORRELATION': 0.3645815707005265}, 'times': {'contamination': 0.00035500526428222656, 'optimization': 2490.3838233947754, 'imputation': 172.1408417224884, 'log_imputation': 2.2358839222182225}}, '0.2': {'scores': {'RMSE': 0.9110420539797002, 'MAE': 0.745272313719031, 'MI': 0.10485836951846873, 'CORRELATION': 0.0054087048337242045}, 'times': {'contamination': 0.00034427642822265625, 'optimization': 2490.3838233947754, 'imputation': 171.6305854320526, 'log_imputation': 2.2345946838666526}}, '0.4': {'scores': {'RMSE': 0.8460413026141097, 'MAE': 0.653976961624171, 'MI': 0.07200416729866779, 'CORRELATION': 0.24419152512191655}, 'times': {'contamination': 0.0006928443908691406, 'optimization': 2490.3838233947754, 'imputation': 52.72139310836792, 'log_imputation': 1.7219868775207656}}, '0.6': {'scores': {'RMSE': 0.9333885896416907, 'MAE': 0.7180889165842521, 'MI': 0.05628639258400244, 'CORRELATION': 0.14594274067119267}, 'times': {'contamination': 0.001840353012084961, 'optimization': 2490.3838233947754, 'imputation': 52.330716133117676, 'log_imputation': 1.7187566779946477}}, '0.7': {'scores': {'RMSE': 0.9662179231561216, 'MAE': 0.744413195682356, 'MI': 0.0587647716462166, 'CORRELATION': 0.14330531126837864}, 'times': {'contamination': 0.0018398761749267578, 'optimization': 2490.3838233947754, 'imputation': 50.53941249847412, 'log_imputation': 1.7036301891043986}}}}, 'mpin': {'ray_tune': {'0.05': {'scores': {'RMSE': 0.9925272461717889, 'MAE': 0.7461083558118482, 'MI': 0.5348692435514593, 'CORRELATION': -0.007667736330282676}, 'times': {'contamination': 0.00036644935607910156, 'optimization': 7.812181711196899, 'imputation': 0.5112149715423584, 'log_imputation': -0.29139643582966285}}, '0.1': {'scores': {'RMSE': 1.1680441592588726, 'MAE': 0.9781717371399381, 'MI': 0.11371116243625422, 'CORRELATION': -0.016646509270680725}, 'times': {'contamination': 0.0002243518829345703, 'optimization': 7.812181711196899, 'imputation': 0.4404561519622803, 'log_imputation': -0.35609731973472436}}, '0.2': {'scores': {'RMSE': 0.9408439748172953, 'MAE': 0.7285930425690125, 'MI': 0.04098822429350485, 'CORRELATION': 0.04181051886506206}, 'times': {'contamination': 0.00023174285888671875, 'optimization': 7.812181711196899, 'imputation': 0.4183802604675293, 'log_imputation': -0.37842881403623974}}, '0.4': {'scores': {'RMSE': 1.0052976858981615, 'MAE': 0.786965308522399, 'MI': 0.01344178556294245, 'CORRELATION': 0.024681873992244058}, 'times': {'contamination': 0.0006501674652099609, 'optimization': 7.812181711196899, 'imputation': 0.40064024925231934, 'log_imputation': -0.3972454226158039}}, '0.6': {'scores': {'RMSE': 0.9548251319263584, 'MAE': 0.7511442207051872, 'MI': 0.00930135623468233, 'CORRELATION': -0.01575182086616044}, 'times': {'contamination': 0.0012600421905517578, 'optimization': 7.812181711196899, 'imputation': 0.4070866107940674, 'log_imputation': -0.39031318146702354}}, '0.7': {'scores': {'RMSE': 0.9446318662376141, 'MAE': 0.744122264330064, 'MI': 0.007539213289227095, 'CORRELATION': -0.018240287271113223}, 'times': {'contamination': 0.0017695426940917969, 'optimization': 7.812181711196899, 'imputation': 0.39906764030456543, 'log_imputation': -0.3989534869665162}}}}, 'pristi': {'ray_tune': {'0.05': {'scores': {'RMSE': 55.960116992995445, 'MAE': 46.4096472319626, 'MI': 0.42064699601068534, 'CORRELATION': 0.04507016986244122}, 'times': {'contamination': 0.00011730194091796875, 'optimization': 76.60794115066528, 'imputation': 29.775820016860962, 'log_imputation': 1.47386373065503}}, '0.1': {'scores': {'RMSE': 57.538277532977055, 'MAE': 46.82173605706819, 'MI': 0.08824583086697571, 'CORRELATION': 0.0434011572132245}, 'times': {'contamination': 0.00023126602172851562, 'optimization': 76.60794115066528, 'imputation': 30.05645751953125, 'log_imputation': 1.4779377929381963}}, '0.2': {'scores': {'RMSE': 60.808746540345666, 'MAE': 48.85156592826631, 'MI': 0.03497257877394178, 'CORRELATION': -0.028840216845075817}, 'times': {'contamination': 0.00027680397033691406, 'optimization': 76.60794115066528, 'imputation': 30.277715921401978, 'log_imputation': 1.4811231099249287}}, '0.4': {'scores': {'RMSE': 61.76763817066328, 'MAE': 49.5988990990065, 'MI': 0.007898084001455433, 'CORRELATION': 0.0030498998829152878}, 'times': {'contamination': 0.0006997585296630859, 'optimization': 76.60794115066528, 'imputation': 28.5592999458313, 'log_imputation': 1.4557475576773615}}, '0.6': {'scores': {'RMSE': 61.98612564576895, 'MAE': 49.755647879167334, 'MI': 0.004322458488836388, 'CORRELATION': 0.01233963956767782}, 'times': {'contamination': 0.0013575553894042969, 'optimization': 76.60794115066528, 'imputation': 32.24260687828064, 'log_imputation': 1.5084301481170062}}, '0.7': {'scores': {'RMSE': 62.379540899173236, 'MAE': 50.156074239740796, 'MI': 0.0031404425022982423, 'CORRELATION': 0.009111022593762223}, 'times': {'contamination': 0.0018019676208496094, 'optimization': 76.60794115066528, 'imputation': 35.09843707084656, 'log_imputation': 1.545287777815695}}}}}}}
    Benchmark().generate_plots(runs_plots_scores=test_plots, ticks=range, subplot=False, y_size=max(4, int(len(algorithms)*0.28)), save_dir=save_dir)
    Benchmark().generate_plots(runs_plots_scores=test_plots, ticks=range, subplot=True, y_size=max(4, int(len(algorithms)*0.28)),save_dir=save_dir)
    Benchmark().generate_reports_txt(runs_plots_scores=test_plots, save_dir=save_dir, dataset="chlorine", run=0)
    Benchmark().generate_reports_excel(runs_plots_scores=test_plots, save_dir=save_dir, dataset="chlorine", run=0)

    Benchmark().generate_heatmap(np.array([[1.12395851, 0.6470281, 0.67607129, 0.52176976, 0.52304288, 0.36444636, 0.89733918, 0.35040938, 0.35273418, 0.96177331, 0.53492822, 1.20178291, 54.63150047, 0.89519623, 0.36984999, 100., 0.91834629, 0.4267107, 100.], [1.10116065, 1.06258333, 0.95263409, 0.67823842, 2.30571521, 0.76078378, 0.87041159, 1.77119164, 0.78415296, 1.03505842, 1.00102834, 1.36935127, 60.07340763, 0.88553276, 1.73914404, 100., 4.04583674, 0.67136028, 100.]]),
                                 np.array(['brits', 'cdrec', 'deep_mvi', 'dynammo', 'grouse', 'iim', 'interpolation', 'iter_svd', 'knn', 'mean', 'mpin', 'mrnn', 'pristi', 'rosl', 'soft_imp', 'spirit', 'stmvl', 'svt', 'tkcm']),
                                 np.array(['eegalcohol', 'eegreading']), save_dir=save_dir, display=False)
