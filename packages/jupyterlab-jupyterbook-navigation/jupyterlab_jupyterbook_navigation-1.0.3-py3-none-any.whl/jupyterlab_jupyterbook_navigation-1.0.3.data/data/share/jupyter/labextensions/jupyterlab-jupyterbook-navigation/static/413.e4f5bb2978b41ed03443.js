(self.webpackChunkjupyterlab_jupyterbook_navigation=self.webpackChunkjupyterlab_jupyterbook_navigation||[]).push([[413],{413:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v,getJupyterAppInstance:()=>b});var o=n(807),r=n(256),i=n(358),a=n(643),c=n(975),l=n(769);async function s(t){try{const e=b(),n=await e.serviceManager.contents.get(t,{content:!0});if("notebook"===n.type||"file"===n.type)return n.content;throw new Error(`Unsupported file type: ${n.type}`)}catch(e){throw console.error(`Failed to get file contents for ${t}:`,e),e}}function u(t){return t&&"object"==typeof t&&Array.isArray(t.cells)}async function f(t){const e=c.extname(t);if(".ipynb"===e)try{const e=await s(t);if(u(e)){const t=e.cells.filter((t=>"markdown"===t.cell_type&&(Array.isArray(t.source)?t.source.join(""):t.source).split("\n").some((t=>t.startsWith("# "))))),n=t.length>0?t[0]:null;if(n&&"# "===n.source.split("\n")[0].slice(0,2))return n.source.split("\n")[0].slice(2)}}catch(t){console.error("Error reading or parsing notebook:",t)}else if(".md"===e)try{const e=await s(t);if(!u(e)){const t=e.split("\n");for(const e of t)if("# "===e.slice(0,2))return e.slice(2)}}catch(t){console.error("Error reading or parsing Markdown:",t)}return null}async function p(t){""===t&&(t="/");try{const e=b();return await e.serviceManager.contents.get(t,{content:!0})}catch(t){return console.error("Error listing directory contents:",t),null}}async function h(t){const e=[];try{const n=b(),o=await n.serviceManager.contents.get("",{content:!0}),r=new RegExp(t);for(const t of o.content)"file"===t.type&&r.test(t.path)&&e.push(t.path)}catch(e){console.error(`Error globbing pattern ${t}`,e)}return e}async function d(t,e){const n=await p(e);for(const e of Object.values(n.content)){const n=e;if(n.path.includes(t))return n.path}return`Unable to locate ${t} in ${e}`}async function g(t,e,n=1,o=""){async function r(t){const r=t.split("/");r.pop();const i=r.join("/"),a=await d(t,`${e}${i}`);let c=await f(a);c||(c=t),o+=`<button class="jp-Button toc-button tb-level${n}" style="display: block;" data-file-path="${a}">${c}</button>`}e&&"/"!==e.slice(-1)&&(e+="/");for(const i of t)if(i.sections&&i.file){const t=i.file.split("/");t.pop();const r=t.join("/"),a=await d(i.file,`${e}${r}`);let c=await f(a);c||(c=i.file);const l=o+=`\n        <div>\n            <button class="jp-Button toc-button tb-level${n}"style="display: inline-block;" data-file-path="${a}">${c}</button>\n            <button class="jp-Button toc-chevron" style="display: inline-block;"><i class="fa fa-chevron-down "></i></button>\n        </div>\n        <div style="display: none;">\n        `;o=await g(i.sections,e,n+=1,o=l),n-=1,o+="</div>"}else if(i.file)await r(i.file);else if(i.url)o+=`<button class="jp-Button toc-button tb-level${n}" style="display:block;"><a class="toc-link tb-level${n}" href="${i.url}" target="_blank" rel="noopener noreferrer" style="display: block;">${i.title}</a></button>`;else if(i.glob){const t=await h(`${e}${i.glob}`);for(const n of t){const t=n.replace(`${e}`,"");await r(t)}}return o}let y=null;function b(t){if(!y&&t&&(y=t),!y)throw new Error("App instance has not been initialized yet");return y}const v={id:"jupyterlab-jupyterbook-navigation:plugin",description:"A JupyterLab extension that mimics jupyter-book chapter navigation on an un-built, cloned jupyter book in JupyterLab.",autoStart:!0,requires:[o.ILabShell,a.IFileBrowserFactory,i.IDocumentManager],activate:async(t,e,n,o)=>{b(t),console.log("JupyterLab extension jupyterlab-jupyterbook-navigation is activated!");const i=new r.Widget;i.id="@jupyterlab-sidepanel/jupyterbook-toc",i.title.iconClass="jbook-icon jp-SideBar-tabIcon",i.title.className="jbook-tab",i.title.caption="Jupyter-Book Table of Contents";const a=document.createElement("p");i.node.appendChild(a),i.activate=async()=>{const t=n.tracker.currentWidget;t?console.debug("Active file browser widget found."):console.debug("File browser widget is null.");try{const e=null==t?void 0:t.model.path;if("string"==typeof e){const t=await async function(t){const e=await async function(t){const e=t.split("/");let n=0;for(;n<1;){const t=e.join("/"),o=await p(t);for(const t of Object.values(o.content)){const e=t;if(e.path.includes("_toc.yml"))return e.path}0===e.length?n+=1:e.pop()}return null}(t);let n=null,o=null;if(e){const t=e.split("/");t.pop(),o=t.join("/");const r=await p(o),i="_config.yml";for(const t of Object.values(r.content)){const e=t;if(e.path.includes(i)){n=e.path;break}}}if(e&&null!=o&&n)try{const t=await s(e);if("string"==typeof t){const e=l.load(t),r=await async function(t){try{const n=await s(t);if("string"==typeof n){const t=l.load(n);if((e=t)&&"object"==typeof e&&e.title&&e.author)return{title:t.title||"Untitled Jupyter Book",author:t.author||"Anonymous"};console.error("Error: Misconfigured Jupyter Book config.")}}catch(t){console.error("Error reading or parsing config:",t)}var e;return{title:null,author:null}}(n),i=await async function(t,e){let n="\n<ul>";if(t.parts)for(const o of t.parts)n+=`\n<p class="caption" role="heading"><span class="caption-text"><b>\n${o.caption}\n</b></span>\n</p>`,n+=`\n${await g(o.chapters,e)}`;else t.chapters&&(n+=`\n${await g(t.chapters,e)}`);return n+="\n</ul>",n}(e,o);return`\n          <div class="jbook-toc" data-toc-dir="${o}"><p id="toc-title">${r.title}</p>\n          <p id="toc-author">Author: ${r.author}</p>\n          ${i} </div>\n            `}console.error("Error: Misconfigured Jupyter Book _toc.yml.")}catch(t){console.error("Error reading or parsing _toc.yml:",t)}return`\n    <p id="toc-title">Not a Jupyter-Book</p>\n    <p id="toc-author">"_toc.yml" and/or "_config.yml" not found in or above:</p>\n    <p id="toc-author">${t}</p>\n    <p id="toc-author">Please navigate to a directory containing a Jupyter-Book to view its Table of Contents</p>\n    `}(e);a.innerHTML=t}!function(t,e){document.querySelectorAll(".toc-button").forEach((n=>{n.addEventListener("click",(o=>{if(console.log("Button clicked"),!t)return void console.error("File browser not found");const r=n.closest(".jbook-toc");if(!r)return void console.error("jbook-toc div not found");if("string"!=typeof r.getAttribute("data-toc-dir"))return void console.error("data-toc-dir attribute loaded");if("string"!=typeof t.model.path)return void console.error(`Invalid path: The current path is either not set or not a string. Path: ${t.model.path}`);console.log(`Current directory: ${t.model.path}`);const i=n.getAttribute("data-file-path");"string"==typeof i&&(i.includes(".md")?e.openOrReveal(i,"Markdown Preview"):e.openOrReveal(i))}))}))}(t,o),document.querySelectorAll(".toc-chevron").forEach((t=>{const e=t;e.addEventListener("click",(t=>{console.log("Button clicked"),function(t){var e;const n=null===(e=t.parentElement)||void 0===e?void 0:e.nextElementSibling;"none"===n.style.display?(n.style.display="block",t.innerHTML='<i class="fa fa-chevron-up toc-chevron"></i>'):(n.style.display="none",t.innerHTML='<i class="fa fa-chevron-down toc-chevron"></i>')}(e)}))}))}catch(t){console.error(`The jupyterlab_jupyterbook_navigation error: ${t}`)}},e.add(i,"left",{rank:400}),i.activate()}}},975:(t,e,n)=>{"use strict";var o=n(606);function r(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function i(t,e){for(var n,o="",r=0,i=-1,a=0,c=0;c<=t.length;++c){if(c<t.length)n=t.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(i===c-1||1===a);else if(i!==c-1&&2===a){if(o.length<2||2!==r||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){var l=o.lastIndexOf("/");if(l!==o.length-1){-1===l?(o="",r=0):r=(o=o.slice(0,l)).length-1-o.lastIndexOf("/"),i=c,a=0;continue}}else if(2===o.length||1===o.length){o="",r=0,i=c,a=0;continue}e&&(o.length>0?o+="/..":o="..",r=2)}else o.length>0?o+="/"+t.slice(i+1,c):o=t.slice(i+1,c),r=c-i-1;i=c,a=0}else 46===n&&-1!==a?++a:a=-1}return o}var a={resolve:function(){for(var t,e="",n=!1,a=arguments.length-1;a>=-1&&!n;a--){var c;a>=0?c=arguments[a]:(void 0===t&&(t=o.cwd()),c=t),r(c),0!==c.length&&(e=c+"/"+e,n=47===c.charCodeAt(0))}return e=i(e,!n),n?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(t){if(r(t),0===t.length)return".";var e=47===t.charCodeAt(0),n=47===t.charCodeAt(t.length-1);return 0!==(t=i(t,!e)).length||e||(t="."),t.length>0&&n&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return r(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var n=arguments[e];r(n),n.length>0&&(void 0===t?t=n:t+="/"+n)}return void 0===t?".":a.normalize(t)},relative:function(t,e){if(r(t),r(e),t===e)return"";if((t=a.resolve(t))===(e=a.resolve(e)))return"";for(var n=1;n<t.length&&47===t.charCodeAt(n);++n);for(var o=t.length,i=o-n,c=1;c<e.length&&47===e.charCodeAt(c);++c);for(var l=e.length-c,s=i<l?i:l,u=-1,f=0;f<=s;++f){if(f===s){if(l>s){if(47===e.charCodeAt(c+f))return e.slice(c+f+1);if(0===f)return e.slice(c+f)}else i>s&&(47===t.charCodeAt(n+f)?u=f:0===f&&(u=0));break}var p=t.charCodeAt(n+f);if(p!==e.charCodeAt(c+f))break;47===p&&(u=f)}var h="";for(f=n+u+1;f<=o;++f)f!==o&&47!==t.charCodeAt(f)||(0===h.length?h+="..":h+="/..");return h.length>0?h+e.slice(c+u):(c+=u,47===e.charCodeAt(c)&&++c,e.slice(c))},_makeLong:function(t){return t},dirname:function(t){if(r(t),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,o=-1,i=!0,a=t.length-1;a>=1;--a)if(47===(e=t.charCodeAt(a))){if(!i){o=a;break}}else i=!1;return-1===o?n?"/":".":n&&1===o?"//":t.slice(0,o)},basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');r(t);var n,o=0,i=-1,a=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var c=e.length-1,l=-1;for(n=t.length-1;n>=0;--n){var s=t.charCodeAt(n);if(47===s){if(!a){o=n+1;break}}else-1===l&&(a=!1,l=n+1),c>=0&&(s===e.charCodeAt(c)?-1==--c&&(i=n):(c=-1,i=l))}return o===i?i=l:-1===i&&(i=t.length),t.slice(o,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!a){o=n+1;break}}else-1===i&&(a=!1,i=n+1);return-1===i?"":t.slice(o,i)},extname:function(t){r(t);for(var e=-1,n=0,o=-1,i=!0,a=0,c=t.length-1;c>=0;--c){var l=t.charCodeAt(c);if(47!==l)-1===o&&(i=!1,o=c+1),46===l?-1===e?e=c:1!==a&&(a=1):-1!==e&&(a=-1);else if(!i){n=c+1;break}}return-1===e||-1===o||0===a||1===a&&e===o-1&&e===n+1?"":t.slice(e,o)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return function(t,e){var n=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+o:n+"/"+o:o}(0,t)},parse:function(t){r(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var n,o=t.charCodeAt(0),i=47===o;i?(e.root="/",n=1):n=0;for(var a=-1,c=0,l=-1,s=!0,u=t.length-1,f=0;u>=n;--u)if(47!==(o=t.charCodeAt(u)))-1===l&&(s=!1,l=u+1),46===o?-1===a?a=u:1!==f&&(f=1):-1!==a&&(f=-1);else if(!s){c=u+1;break}return-1===a||-1===l||0===f||1===f&&a===l-1&&a===c+1?-1!==l&&(e.base=e.name=0===c&&i?t.slice(1,l):t.slice(c,l)):(0===c&&i?(e.name=t.slice(1,a),e.base=t.slice(1,l)):(e.name=t.slice(c,a),e.base=t.slice(c,l)),e.ext=t.slice(a,l)),c>0?e.dir=t.slice(0,c-1):i&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,t.exports=a},606:t=>{var e,n,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var c,l=[],s=!1,u=-1;function f(){s&&c&&(s=!1,c.length?l=c.concat(l):u=-1,l.length&&p())}function p(){if(!s){var t=a(f);s=!0;for(var e=l.length;e;){for(c=l,l=[];++u<e;)c&&c[u].run();u=-1,e=l.length}c=null,s=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new h(t,e)),1!==l.length||s||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}}]);