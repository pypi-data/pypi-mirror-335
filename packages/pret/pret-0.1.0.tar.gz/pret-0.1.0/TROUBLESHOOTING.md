# TROUBLESHOOTING
### Cannot find module '<...>/pyodide.asm.js.

```
Cannot find module '<...>/pyodide.asm.js.**
```
found at runtime.

Caused by Webpack trying to bundle the import(dynamic_url) statement generated by pyodide.
Cannot ignore the error globally from webpack.config.js using a flag, so it required using string-replace
loader and add /* webpackIgnore: true */ to each import statement of the pyodide.mjs file.

### Pret is not loaded and shows a repr of the object instead of displaying it

Check that the `js-extension` folder copied in share/jupyter contains a remoteEntry file. If that is
the case, an error should be displayed in the console. If not, there is no loading. The cause for 
missing remoteEntry can be that the `jlpm build` command called during the source install `pip install pret` failed.
In this case, call `jlpm build` directly in the root dir and check the result.

### Failed to fetch dynamically imported module: webpack-internal:///node_modules/pyodide/pyodide.asm.js

- tentative avec quart-cors ðŸš«
- roll back `loadPyodide()` => `loadPyodide({indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/"})` âœ…

### "Schema not found: /opt/homebrew/anaconda3/envs/pret/share/jupyter/lab/schemas/pret/plugin.json" and "Loading chunk client_style_css-client_dist-globals_ts"

When installed in non editable mode both pret and metanno.
Can't load "client_style_css-client_dist-globals_ts.2b34961e7a73490b4531.js", although it is stored in a visible location at /opt/homebrew/anaconda3/envs/pret/share/jupyter/labextensions/metanno/static but if I rename it to something else like "old_file.js", then it works.
Solution was to restart jupyter server âœ…

### Objects are not valid as a React child (found: object with keys {\$\$typeof, type, key, ref, props}). If you meant to render a collection of children, use an array instead. (\$\$typeof Symbol(react.transitional.element))

Might be related to React 19 elements: https://github.com/withastro/astro/issues/12684
After building the lib to `/dist` and then building pret extension based on `/dist/index.js`.
It looks like "react-jsx-runtime.production.js" is in the build.

Actually it was because react was in the dev dependencies and react/jsx-runtime was added into the build with support for react 19. We need to remove react from the extension, but the react/jsx-runtime is expected since it's added by the typescript compiler cf https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html.

How do we compile an extension without including react into the build ? May be look at react-dnd and an example for another jupyterlab extension.
- react-dnd only runs tsc, no webpack, so it expects react to be provided by the app that imports it

The example from Jupyter doesn't tell anything: https://github.com/jupyterlab/extension-examples/blob/71486d7b891175fb3883a8b136b8edd2cd560385/react/react-widget/

I'm going back to adding react as a devDependency.

Now there is an issue with css-loader... it's not up to date but it's not one of my dependencies, maybe there is a conflict between react-scripts and jupyter-builder ? Updating css-loader to >7 fixed the issue. It looks like jupyterbuilder <4 has some dependencies issues.

So it's great, but now we have multiple react/jsx-runtime in the same app, why can't we share them ?


### Weird typescript errors

like 
```
file: '/Users/perceval/Development/metanno/node_modules/@types/node/http.d.ts',
          loc: '345:25-26',
          message: '[tsl] ERROR in /Users/perceval/Development/metanno/node_modules/@types/node/http.d.ts(345,26)\n'
```
Upgrade to typescript 5.8.2 fixed the issue.
I had to change the stub script to adjust for this

### Weird bug with react-simple-dock and tableview/datagrid

Happens when I fiddle with panels and put (I think) a different tableview at the position of a ormer tableview. I guess DataGrid makes some optimizations and doesn't re-render the component properly, and react tries to reconcile two datagrids with different data.

Anyway, this causes a weird bug, always the same, where 14 of 17 columns passed a prop to the datagrid become undefined. It's weird because:
1. I never update the columns
2. The prop shouldn't change if I don't update it

### Running on jlab 4 and got "Class constructor M cannot be invoked without 'new'"

Fixed by changing tsconfig.json to target es6 instead of es5.
