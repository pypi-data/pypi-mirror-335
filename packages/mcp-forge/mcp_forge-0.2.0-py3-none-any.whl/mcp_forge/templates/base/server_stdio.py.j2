"""{{ config.project_name }} MCP Server implementation."""

from mcp.server.fastmcp import FastMCP
from typing import List, Dict, Any

from {{ config.package_name }}.services.tool_service import ToolService
from {{ config.package_name }}.interfaces.tool import Tool
from {{ config.package_name }}.tools import HelloWorldTool


def get_available_tools() -> List[Tool]:
    """Get list of all available tools."""
    return [
        HelloWorldTool(),
        # Add more tools here as they are created
    ]


def main():
    """Entry point for the server."""
    mcp = FastMCP("{{ config.project_name }}")
    tool_service = ToolService()

    # Register all available tools
    tool_service.register_tools(get_available_tools())

    # Register MCP handlers for each tool
    for tool in get_available_tools():
        @mcp.tool(name=tool.name, description=tool.description)
        async def tool_handler(args: Dict[str, Any], tool_instance=tool) -> str:
            """Handle tool call."""
            result = await tool_service.execute_tool(tool_instance.name, args)
            return result.content[0].text

    mcp.run()


if __name__ == "__main__":
    main()
