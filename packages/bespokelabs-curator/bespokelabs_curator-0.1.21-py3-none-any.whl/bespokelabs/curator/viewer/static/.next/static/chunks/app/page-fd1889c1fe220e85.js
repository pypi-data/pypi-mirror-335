(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{29487:(e,t,s)=>{Promise.resolve().then(s.bind(s,87656))},87656:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(57437),n=s(2265),r=s(16463),l=s(92694),o=s(35657),i=s(3274),c=s(37440),d=s(89669),m=s(76780),u=s(50495),p=s(22468),h=s(6884),x=s(32618),f=s.n(x);s(78544),s(96742);let g=e=>{let{code:t}=e,[s,r]=n.useState(!1);n.useEffect(()=>{f().highlightAll()},[t]);let l=async()=>{await navigator.clipboard.writeText(t),r(!0),setTimeout(()=>r(!1),2e3)};return(0,a.jsxs)("div",{className:"relative rounded-lg overflow-x-auto",children:[(0,a.jsx)("div",{className:"absolute right-2 top-2",children:(0,a.jsx)(u.z,{size:"icon",variant:"ghost",className:"h-8 w-8 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",onClick:l,children:s?(0,a.jsx)(p.Z,{className:"h-4 w-4"}):(0,a.jsx)(h.Z,{className:"h-4 w-4"})})}),(0,a.jsx)("pre",{className:"bg-gray-900 p-4 m-0",style:{fontSize:"12px"},children:(0,a.jsx)("code",{className:"language-python",children:t})})]})},y=[{key:"created_time",label:"Created"},{key:"last_edited_time",label:"Last Updated"},{key:"model_name",label:"Model"},{key:"prompt_func",label:"Prompter Function"},{key:"response_format",label:"Response Format"}];function b(){let[e,t]=(0,n.useState)([]),[s,u]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[x,f]=(0,n.useState)(!0),[b,w]=(0,n.useState)(null),[j,N]=(0,n.useState)(new Set),v=(0,r.useRouter)(),{toast:_}=(0,o.pm)(),[k,C]=(0,n.useState)(null),S=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let s=b&&!e?"?lastCreatedTime=".concat(b):"",a=await fetch("/api/runs".concat(s)),n=await a.json();if(404===a.status&&"NO_CACHE_DB"===n.error){C({message:n.message,path:n.path}),f(!1),u(!1);return}if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));if(!Array.isArray(n))throw Error("Data is not in the expected format");if(n.length>0){if(e)t(n),w(n[0].created_time);else if(n.length>0){let e=new Set(n.map(e=>e.run_hash));N(e),t(e=>[...n,...e]),w(n[0].created_time),_({title:"New runs available",description:"".concat(n.length," new runs added")}),setTimeout(()=>{N(new Set)},5e3)}}}catch(e){console.error("Failed to fetch runs:",e),h(e instanceof Error?e.message:"Failed to fetch runs"),_({variant:"destructive",title:"Error",description:"Failed to fetch new runs"})}finally{u(!1)}},[b,_]);return((0,n.useEffect)(()=>{S(!0)},[S]),(0,n.useEffect)(()=>{if(!x)return;let e=setInterval(()=>{S(!1)},5e3);return()=>clearInterval(e)},[x,S]),p)?(0,a.jsxs)("div",{children:["Error: ",p]}):(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground overflow-x-hidden",children:[(0,a.jsx)(d.h,{isLoading:s,isPolling:x,onTogglePolling:()=>f(e=>!e),pollingText:"Polling for updates...",loadingText:"Loading runs..."}),(0,a.jsxs)("main",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:"Curator Runs History"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"View and analyze your past Bespoke Curator runs"})]}),k?(0,a.jsx)("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 dark:border-yellow-900/50 dark:bg-yellow-900/20 p-4 my-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-yellow-600 dark:text-yellow-500",children:"No Cache Database Found"}),(0,a.jsx)("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-1",children:k.message}),(0,a.jsxs)("p",{className:"text-xs text-yellow-500 dark:text-yellow-400 mt-2 font-mono",children:["Expected location: ",k.path]})]})]}),(0,a.jsxs)("div",{className:"mt-4 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-400 mb-2",children:"Try running this example to create your first curator run:"}),(0,a.jsx)(g,{code:'from typing import Dict, List\n\nfrom datasets import Dataset\nfrom pydantic import BaseModel, Field\n\nfrom bespokelabs import curator\n\n\nclass Poem(BaseModel):\n    poem: str = Field(description="A poem.")\n\n\nclass Poems(BaseModel):\n    poems: List[Poem] = Field(description="A list of poems.")\n\n\nclass Poet(curator.LLM):\n    response_format = Poems\n\n    def prompt(self, input: Dict) -> str:\n        return f"Write two poems about {input[\'topic\']}."\n\n    def parse(self, input: Dict, response: Poems) -> Dict:\n        return [{"topic": input["topic"], "poem": p.poem} for p in response.poems]\n\n\npoet = Poet(model_name="gpt-4o-mini")\n\ntopics = Dataset.from_dict({"topic": ["Urban loneliness in a bustling city", "Beauty of Bespoke Labs\'s Curator library"]})\npoem = poet(topics)\nprint(poem.to_pandas())\n# Output:\n#                                       topic                                               poem\n# 0       Urban loneliness in a bustling city  In the city’s heart, where the lights never di...\n# 1       Urban loneliness in a bustling city  Steps echo loudly, pavement slick with rain,\n...\n# 2  Beauty of Bespoke Labs\'s Curator library  In the heart of Curation’s realm,  \nWhere art...\n# 3  Beauty of Bespoke Labs\'s Curator library  Step within the library’s embrace,  \nA sanctu...\n'})]})]})}):s?(0,a.jsx)("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(i.Z,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading runs..."})]})}):0===e.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No runs found"})}):(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(l.d,{columns:y,data:e,getRowKey:e=>e.id,getCellContent:(e,t)=>{switch(t){case"created_time":return new Date(e.created_time).toLocaleString();case"last_edited_time":return"-"===e.last_edited_time?"-":new Date(e.last_edited_time).toLocaleString();default:return e[t]}},onRowClick:e=>v.push("/dataset/".concat(e.run_hash,"?batchMode=").concat(e.batch_mode)),truncateConfig:{enabled:!0,maxLength:100},pageSize:10,rowProps:e=>({className:(0,c.cn)(j.has(e.id)&&"bg-success/30 animate-highlight","transition-colors duration-300")})})})]})]})}function w(){return(0,a.jsx)(b,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[529,701,364,371,883,130,215,744],()=>t(29487)),_N_E=e.O()}]);